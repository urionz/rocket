function module(e,t,a){let n,i,s,r,o,l,c,v,g,u,m,p;a.link("meteor/meteor",{Meteor(e){n=e}},0),a.link("meteor/reactive-var",{ReactiveVar(e){i=e}},1),a.link("meteor/tracker",{Tracker(e){s=e}},2),a.link("meteor/templating",{Template(e){r=e}},3),a.link("moment",{default(e){o=e}},4),a.link("../../../../../utils",{handleError(e){l=e}},5),a.link("../../../../../ui-utils",{popover(e){c=e}},6),a.link("../../../lib/chartHandler",{drawLineChart(e){v=e}},7),a.link("../../../lib/dateHandler",{setDateRange(e){g=e},updateDateRange(e){u=e}},8),a.link("./livechatAnalytics.html");const h=()=>[{name:"Conversations",value:"conversations",chartOptions:[{name:"Total_conversations",value:"total-conversations"},{name:"Avg_chat_duration",value:"avg-chat-duration"},{name:"Total_messages",value:"total-messages"}]},{name:"Productivity",value:"productivity",chartOptions:[{name:"Avg_first_response_time",value:"avg-first-response-time"},{name:"Best_first_response_time",value:"best_first_response_time"},{name:"Avg_response_time",value:"avg-response-time"},{name:"Avg_reaction_time",value:"avg-reaction-time"}]}],d=(e,t)=>{const a=[];for(;e.length;){const n=Math.ceil(e.length/t--),i=e.slice(0,n);a.push(i),e=e.slice(n)}return a},_=()=>{const e={daterange:{from:o(m.daterange.get().from,"MMM D YYYY").toISOString(),to:o(m.daterange.get().to,"MMM D YYYY").toISOString()},chartOptions:m.chartOptions.get()};n.call("livechat:getAnalyticsChartData",e,(async function(e,t){if(e)return l(e);t&&t.chartLabel&&t.dataLabels&&t.dataPoints||console.log("livechat:getAnalyticsChartData => Missing Data"),p=await v(document.getElementById("lc-analytics-chart"),p,[t.chartLabel],t.dataLabels,[t.dataPoints])})),n.call("livechat:getAgentOverviewData",e,(function(e,t){if(e)return l(e);t||console.log("livechat:getAgentOverviewData => Missing Data"),m.agentOverviewData.set(t)}))},O=()=>{const e={daterange:{from:o(m.daterange.get().from,"MMM D YYYY").toISOString(),to:o(m.daterange.get().to,"MMM D YYYY").toISOString()},analyticsOptions:m.analyticsOptions.get()};n.call("livechat:getAnalyticsOverviewData",e,(e,t)=>{if(e)return l(e);t||console.log("livechat:getAnalyticsOverviewData => Missing Data"),m.analyticsOverviewData.set(d(t,3))})};r.livechatAnalytics.helpers({analyticsOverviewData:()=>m.analyticsOverviewData.get(),agentOverviewData:()=>m.agentOverviewData.get(),analyticsAllOptions:()=>[{name:"Conversations",value:"conversations",chartOptions:[{name:"Total_conversations",value:"total-conversations"},{name:"Avg_chat_duration",value:"avg-chat-duration"},{name:"Total_messages",value:"total-messages"}]},{name:"Productivity",value:"productivity",chartOptions:[{name:"Avg_first_response_time",value:"avg-first-response-time"},{name:"Best_first_response_time",value:"best_first_response_time"},{name:"Avg_response_time",value:"avg-response-time"},{name:"Avg_reaction_time",value:"avg-reaction-time"}]}],analyticsOptions:()=>m.analyticsOptions.get(),daterange:()=>m.daterange.get(),selected:e=>(e===m.analyticsOptions.get().value||e===m.chartOptions.get().value)&&"selected",showLeftNavButton:()=>"custom"!==m.daterange.get().value,showRightNavButton:()=>"custom"!==m.daterange.get().value&&"today"!==m.daterange.get().value&&"this-week"!==m.daterange.get().value&&"this-month"!==m.daterange.get().value}),r.livechatAnalytics.onCreated((function(){m=r.instance(),this.analyticsOverviewData=new i,this.agentOverviewData=new i,this.daterange=new i({}),this.analyticsOptions=new i({name:"Conversations",value:"conversations",chartOptions:[{name:"Total_conversations",value:"total-conversations"},{name:"Avg_chat_duration",value:"avg-chat-duration"},{name:"Total_messages",value:"total-messages"}]}),this.chartOptions=new i({name:"Total_conversations",value:"total-conversations"}),this.autorun(()=>{m.daterange.set(g())})})),r.livechatAnalytics.onRendered(()=>{s.autorun(()=>{m.daterange.get()&&m.analyticsOptions.get()&&m.chartOptions.get()&&(O(),_())})}),r.livechatAnalytics.events({"click .lc-date-picker-btn"(e){e.preventDefault();const t=[],a={template:"livechatAnalyticsDaterange",currentTarget:e.currentTarget,data:{options:t,daterange:m.daterange},offsetVertical:e.currentTarget.clientHeight+10};c.open(a)},"click .lc-daterange-prev"(e){e.preventDefault(),m.daterange.set(u(m.daterange.get(),-1))},"click .lc-daterange-next"(e){e.preventDefault(),m.daterange.set(u(m.daterange.get(),1))},"change #lc-analytics-options"(e){e.preventDefault(),m.analyticsOptions.set([{name:"Conversations",value:"conversations",chartOptions:[{name:"Total_conversations",value:"total-conversations"},{name:"Avg_chat_duration",value:"avg-chat-duration"},{name:"Total_messages",value:"total-messages"}]},{name:"Productivity",value:"productivity",chartOptions:[{name:"Avg_first_response_time",value:"avg-first-response-time"},{name:"Best_first_response_time",value:"best_first_response_time"},{name:"Avg_response_time",value:"avg-response-time"},{name:"Avg_reaction_time",value:"avg-reaction-time"}]}].filter((function(t){return t.value===e.currentTarget.value}))[0]),m.chartOptions.set(m.analyticsOptions.get().chartOptions[0])},"change #lc-analytics-chart-options"(e){e.preventDefault(),m.chartOptions.set(m.analyticsOptions.get().chartOptions.filter((function(t){return t.value===e.currentTarget.value}))[0])}})}

