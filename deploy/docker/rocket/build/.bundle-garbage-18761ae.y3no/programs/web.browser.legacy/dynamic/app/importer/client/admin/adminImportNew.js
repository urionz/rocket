function module(e,t,i){var n,r,o,l,p,a,c,u,s,f,m,d;i.link("meteor/tracker",{Tracker:function(e){n=e}},0),i.link("meteor/kadira:flow-router",{FlowRouter:function(e){r=e}},1),i.link("meteor/templating",{Template:function(e){o=e}},2),i.link("meteor/rocketchat:tap-i18n",{TAPi18n:function(e){l=e}},3),i.link("meteor/reactive-var",{ReactiveVar:function(e){p=e}},4),i.link("toastr",{default:function(e){a=e}},5),i.link("../../../utils",{t:function(e){c=e},APIClient:function(e){u=e}},6),i.link("../../../ui-utils/client",{SideNav:function(e){s=e}},7),i.link("../../../settings",{settings:function(e){f=e}},8),i.link("../functions/showImporterException",{showImporterException:function(e){m=e}},9),i.link("..",{Importers:function(e){d=e}},10),i.link("./adminImportNew.html"),o.adminImportNew.helpers({isPreparing:function(){return o.instance().preparing.get()},importers:function(){return d.getAll()},pageTitle:function(){var e=o.instance().importType.get();if(!e)return c("Import_New_File");var t=d.get(e);return t?l.__("Importer_From_Description",{from:c(t.name)}):c("Import_New_File")},importType:function(){return o.instance().importType.get()},fileType:function(){return o.instance().fileType.get()},isImporterSelected:function(){return o.instance().importType.get()},isFileTypeSelected:function(){return o.instance().fileType.get()},isUpload:function(){return"upload"===o.instance().fileType.get()},isPublicURL:function(){return"url"===o.instance().fileType.get()},isServerFile:function(){return"path"===o.instance().fileType.get()},fileSizeLimitMessage:function(){var e=f.get("FileUpload_MaxFileSize"),t;if(e>0){var i=e/1024,n=i/1024,r;r=n>0?l.__("FileSize_MB",{fileSize:n.toFixed(2)}):i>0?l.__("FileSize_KB",{fileSize:i.toFixed(2)}):l.__("FileSize_Bytes",{fileSize:e.toFixed(0)}),t=l.__("Importer_Upload_FileSize_Message",{maxFileSize:r})}else t=l.__("Importer_Upload_Unlimited_FileSize");return t}}),o.adminImportNew.events({"change .file-type":function(e,t){t.fileType.set($("select[name=file-type]").val())},"change .import-type":function(e,t){t.importType.set($("select[name=import-type]").val())},"change .import-file-input":function(e,t){var i=t.importType.get(),n=e.originalEvent||e,o=n.target.files;o&&0!==o.length||(o=(null!=n.dataTransfer?n.dataTransfer.files:void 0)||[]),Array.from(o).forEach((function(e){t.preparing.set(!0);var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){u.post("v1/uploadImportFile",{binaryContent:n.result.split(";base64,")[1],contentType:e.type,fileName:e.name,importerKey:i}).then((function(){a.success(c("File_uploaded_successfully")),r.go("/admin/import/prepare")})).catch((function(e){e&&(m(e),t.preparing.set(!1))}))}}))},"click .import-btn":function(e,t){var i=t.importType.get(),n=$(".import-file-url").val();t.preparing.set(!0),u.post("v1/downloadPublicImportFile",{fileUrl:n,importerKey:i}).then((function(){a.success(c("Import_requested_successfully")),r.go("/admin/import/prepare")})).catch((function(e){e&&(m(e),t.preparing.set(!1))}))}}),o.adminImportNew.onCreated((function(){this.preparing=new p(!1),this.importType=new p(""),this.fileType=new p("upload")})),o.adminImportNew.onRendered((function(){n.afterFlush((function(){s.setFlex("adminFlex"),s.openFlex()}))}))}

