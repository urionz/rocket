function module(e,t,n){var r,i,u,o,a,c,s,f,d,l,g,v,p,h,b,m,k,S,y,_,C,x,T,R,w,E;n.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),n.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){i=e}},1),n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){u=e}},2),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){o=e}},3),n.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){a=e}},4),n.export({SettingsState:function(){return V},useGroup:function(){return M},useSection:function(){return P},useSettingActions:function(){return Q},useSettingDisabledState:function(){return U},useSectionChangedState:function(){return B},useSetting:function(){return G}}),n.link("@rocket.chat/fuselage-hooks",{useDebouncedCallback:function(e){c=e}},0),n.link("meteor/mongo",{Mongo:function(e){s=e}},1),n.link("meteor/tracker",{Tracker:function(e){f=e}},2),n.link("react",{default:function(e){d=e},createContext:function(e){l=e},useCallback:function(e){g=e},useContext:function(e){v=e},useEffect:function(e){p=e},useLayoutEffect:function(e){h=e},useMemo:function(e){b=e},useReducer:function(e){m=e},useRef:function(e){k=e},useState:function(e){S=e}},3),n.link("../../../../app/ui-admin/client/SettingsCachedCollection",{PrivateSettingsCachedCollection:function(e){y=e}},4),n.link("../../../contexts/SettingsContext",{useBatchSettingsDispatch:function(e){_=e}},5),n.link("../../../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){C=e}},6),n.link("../../../hooks/useEventCallback",{useEventCallback:function(e){x=e}},7),n.link("../../../hooks/useReactiveValue",{useReactiveValue:function(e){T=e}},8),n.link("../../../contexts/TranslationContext",{useTranslation:function(e){R=e},useLoadLanguage:function(e){w=e}},9),n.link("../../../contexts/UserContext",{useUser:function(e){E=e}},10);var D=l({}),L,j=function(){return L?[L,Promise.resolve()]:[L=new y,L.init()]},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e===t||!e&&!t?0:e>t?1:-1},J=function(e,t){return O(e.section,t.section)||O(e.sorter,t.sorter)||O(e.i18nLabel,t.i18nLabel)},N=function(e,t){var n=t.type,r=t.payload,i=e.settings,u=e.persistedSettings;switch(n){case"add":return{settings:[].concat(a(i),a(r)).sort(J),persistedSettings:[].concat(a(u),a(r)).sort(J)};case"change":var c=function(e){return e._id!==r._id?e:r};return{settings:i.map(c),persistedSettings:i.map(c)};case"remove":var s=function(e){return e._id!==r};return{settings:i.filter(s),persistedSettings:u.filter(s)};case"hydrate":var f={};r.forEach((function(e){f[e._id]=e}));var d=function(e){return f[e._id]?o({},e,{},f[e._id]):e};return{settings:i.map(d),persistedSettings:u}}return e};function V(e){var t=e.children,n=S(!0),r=u(n,2),o=r[0],a=r[1],c=S(new Set),f,l=u(c,1)[0],v=k({settings:[],persistedSettings:[]}),h=g((function(e,t){var n=N(e,t);return v.current=n,l.forEach((function(e){e(n)})),n}),[N,l]),y=m(h,{settings:[],persistedSettings:[]}),_,C=u(y,2)[1],x=k({});p((function(){var e=j(),t=u(e,2),n=t[0],r,i=function(){a(!1)};t[1].then(i,i);var o=n.collection,c=new s.Collection(null);x.current={persistedSettingsCollection:o,settingsCollection:c}}),[x]),p((function(){if(!o){var e=x.current,t=e.persistedSettingsCollection,n=e.settingsCollection,r=t.find(),i=r.observe({added:function(e){return n.insert(e)},changed:function(e){return n.update(e._id,e)},removed:function(e){var t=e._id;return n.remove(t)}}),u=[],a,c=r.observe({added:function(e){u.push(e),clearTimeout(a),a=setTimeout((function(){C({type:"add",payload:u})}),70)},changed:function(e){C({type:"change",payload:e})},removed:function(e){var t=e._id;C({type:"remove",payload:t})}});return function(){i&&i.stop(),c&&c.stop(),clearTimeout(a)}}}),[o,x]);var T=k({}),R=g((function(e){var t=e._id,n=i(e,["_id"]),r=x.current.settingsCollection,u=T.current;clearTimeout(u[t]),u[t]=setTimeout((function(){r.update(t,{$set:n})}),70)}),[x,T]),w=g((function(e){e.forEach(R),C({type:"hydrate",payload:e})}),[R,C]),E=g((function(e){var t=e.blocked,n=e.enableQuery;if(t)return!0;if(!n)return!1;var r=x.current.settingsCollection,i;return![].concat("string"==typeof n?JSON.parse(n):n).every((function(e){return!!r.findOne(e)}))}),[x]),L=b((function(){return{subscribers:l,stateRef:v,hydrate:w,isDisabled:E}}),[l,v,w,E]);return d.createElement(D.Provider,{children:t,value:L})}var A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e===t},n=v(D),r=n.subscribers,i=n.stateRef,o=S((function(){return e(i.current)})),a=u(o,2),c=a[0],s=a[1],f=x((function(e,t,n,r){var i=e(r);t(i,n)||s(i)}),e,t,c);return p((function(){return r.add(f),function(){r.delete(f)}}),[f]),h((function(){f(i.current)})),c},M=function(e){var t=A((function(t){return t.settings.find((function(t){var n=t._id,r=t.type;return n===e&&"group"===r}))})),n=function(t){return t.filter((function(t){var n;return t.group===e}))},i=A((function(e){return n(e.settings).some((function(e){var t;return e.changed}))})),u=A((function(e){return Array.from(new Set(n(e.settings).map((function(e){var t;return e.section||""}))))}),(function(e,t){return e.length===t.length&&e.join()===t.join()})),a=_(),c=v(D),s=c.stateRef,f=c.hydrate,d=C(),l=R(),g=w(),p=E(),h=x(function(){function e(e,t,n,i){var u,o,a,c;return r.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:if(u=t.current,o=e(u.settings),0!==(a=o.filter((function(e){var t;return e.changed})).map((function(e){var t,n,r;return{_id:e._id,value:e.value,editor:e.editor}}))).length){s.next=5;break}return s.abrupt("return");case 5:return s.prev=5,s.next=8,r.awrap(n(a));case 8:if(!a.some((function(e){var t;return"Language"===e._id}))){s.next=20;break}return c=i.language||a.filter((function(e){var t;return"Language"===e._id})).shift().value||"en",s.prev=10,s.next=13,r.awrap(g(c));case 13:d({type:"success",message:l("Settings_updated",{lng:c})}),s.next=19;break;case 16:s.prev=16,s.t0=s.catch(10),d({type:"error",message:s.t0});case 19:return s.abrupt("return");case 20:d({type:"success",message:l("Settings_updated")}),s.next=26;break;case 23:s.prev=23,s.t1=s.catch(5),d({type:"error",message:s.t1});case 26:case"end":return s.stop()}}return s}(),null,null,[[5,23],[10,16]])}return e}(),n,s,a,p),b=x((function(e,t,n){var r=t.current,i=e(r.settings),u=e(r.persistedSettings),o;n(i.filter((function(e){var t;return e.changed})).map((function(e){var t=u.find((function(t){var n;return t._id===e._id})),n,r,i;return{_id:t._id,value:t.value,editor:t.editor,changed:!1}})))}),n,s,f);return t&&o({},t,{sections:u,changed:i,save:h,cancel:b})},P=function(e,t){t=t||"";var n=function(n){return n.filter((function(n){var r=n.group,i=n.section;return r===e&&(!t&&!i||t===i)}))},r=A((function(e){return n(e.settings).some((function(e){var t=e.value,n=e.packageValue;return JSON.stringify(t)!==JSON.stringify(n)}))})),i=A((function(e){return n(e.settings).map((function(e){var t;return e._id}))}),(function(e,t){return e.length===t.length&&e.join()===t.join()})),u=v(D),o=u.stateRef,a=u.hydrate,c=u.isDisabled,s=x((function(e,t,n){var r=t.current,i=e(r.settings).filter((function(e){return f.nonreactive((function(){return!c(e)}))})),u=e(r.persistedSettings),o;n(i.map((function(e){var t=u.find((function(t){var n;return t._id===e._id})),n=t._id,r=t.value,i=t.packageValue,o;return{_id:n,value:i,editor:t.editor,changed:i!==r}})))}),n,o,a);return{name:t,canReset:r,settings:i,reset:s}},Q=function(e){var t,n=v(D).hydrate,r,i;return{update:c((function(t){var r=t.value,i=void 0===r?e.value:r,u=t.editor,o=void 0===u?e.editor:u,a=[{_id:e._id,value:i,editor:o,changed:i!==e.value||o!==e.editor}];n(a)}),70,[n,e]),reset:c((function(){var t=e._id,r=e.value,i=e.packageValue,u,o=[{_id:t,value:i,editor:e.editor,changed:JSON.stringify(i)!==JSON.stringify(r)}];n(o)}),70,[n,e])}},U=function(e){var t=e.blocked,n=e.enableQuery,r,i=v(D).isDisabled;return T((function(){return i({blocked:t,enableQuery:n})}),[t,n])},B=function(e,t){return A((function(n){return n.settings.some((function(n){var r=n.group,i=n.section,u=n.changed;return r===e&&(!t&&!i||t===i)&&u}))}))},G=function(e){var t=function(t){return t.find((function(t){return t._id===e}))},n=A((function(e){return t(e.settings)})),r=A((function(e){return t(e.persistedSettings)})),i=Q(r),u=i.update,a=i.reset,c=U(r);return o({},n,{disabled:c,update:u,reset:a})}}

