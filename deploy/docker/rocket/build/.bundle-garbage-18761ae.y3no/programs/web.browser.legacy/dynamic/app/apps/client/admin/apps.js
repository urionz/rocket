function module(e,t,n){var r,a,s,i,o,p,c,u,d,l,f,g,h,v,A,k,m,P;n.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){r=e}},0),n.link("@babel/runtime/regenerator",{default:function(e){a=e}},1),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){s=e}},2),n.link("meteor/kadira:flow-router",{FlowRouter:function(e){i=e}},0),n.link("meteor/reactive-dict",{ReactiveDict:function(e){o=e}},1),n.link("meteor/templating",{Template:function(e){p=e}},2),n.link("meteor/tracker",{Tracker:function(e){c=e}},3),n.link("../../../settings",{settings:function(e){u=e}},4),n.link("../communication",{AppEvents:function(e){d=e}},5),n.link("../orchestrator",{Apps:function(e){l=e}},6),n.link("../../../ui-utils/client",{SideNav:function(e){f=e}},7),n.link("./helpers",{appButtonProps:function(e){g=e},appStatusSpanProps:function(e){h=e},checkCloudLogin:function(e){v=e},handleAPIError:function(e){A=e},promptSubscription:function(e){k=e},triggerAppPopoverMenu:function(e){m=e},warnStatusChange:function(e){P=e}},8),n.link("./apps.html"),p.apps.onCreated((function(){var e=this;this.state=new o({apps:[],isLoading:!0,searchText:"",sortedColumn:"name",isAscendingOrder:!0,page:0,itemsPerPage:0,wasEndReached:!1}),function(){function t(){var t,n,r;return a.async(function(){function i(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,a.awrap(l.getAppsFromMarketplace().catch((function(){return[]})));case 3:return t=i.sent,i.next=6,a.awrap(l.getApps());case 6:n=i.sent,r=n.map((function(e){var n=t.find((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.id;return n===e.id}));return s({},e,n?{installed:!0,categories:n.categories,marketplaceVersion:n.version}:{installed:!0})})),e.state.set("apps",r),i.next=14;break;case 11:i.prev=11,i.t0=i.catch(0),A(i.t0);case 14:return i.prev=14,e.state.set("isLoading",!1),i.finish(14);case 17:case"end":return i.stop()}}return i}(),null,null,[[0,11,14,17]])}return t}()(),this.startAppWorking=function(t){var n=e.state.get("apps"),r;n.find((function(e){var n;return e.id===t})).working=!0,e.state.set("apps",n)},this.stopAppWorking=function(t){var n=e.state.get("apps"),r;delete n.find((function(e){var n;return e.id===t})).working,e.state.set("apps",n)},this.handleAppAddedOrUpdated=function(){function t(t){var n,i,o,p,c;return a.async(function(){function u(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,a.awrap(l.getApp(t));case 3:return n=u.sent,u.next=6,a.awrap(l.getAppFromMarketplace(t,n.version));case 6:if(u.t0=u.sent,u.t0){u.next=9;break}u.t0={};case 9:i=u.t0,o=i.categories,p=i.version,c=[].concat(r(e.state.get("apps").filter((function(e){var n;return e.id!==t}))),[s({},n,{installed:!0,categories:o,marketplaceVersion:p})]),e.state.set("apps",c),u.next=19;break;case 16:u.prev=16,u.t1=u.catch(0),A(u.t1);case 19:case"end":return u.stop()}}return u}(),null,null,[[0,16]])}return t}(),this.handleAppRemoved=function(t){e.state.set("apps",e.state.get("apps").filter((function(e){var n;return e.id!==t})))},this.handleAppStatusChange=function(t){var n=t.appId,r=t.status,a=e.state.get("apps"),s=a.find((function(e){var t;return e.id===n}));s&&(s.status=r,e.state.set("apps",a))},l.getWsListener().registerListener(d.APP_ADDED,this.handleAppAddedOrUpdated),l.getWsListener().registerListener(d.APP_UPDATED,this.handleAppAddedOrUpdated),l.getWsListener().registerListener(d.APP_REMOVED,this.handleAppRemoved),l.getWsListener().registerListener(d.APP_STATUS_CHANGE,this.handleAppStatusChange)})),p.apps.onDestroyed((function(){l.getWsListener().unregisterListener(d.APP_ADDED,this.handleAppAddedOrUpdated),l.getWsListener().unregisterListener(d.APP_UPDATED,this.handleAppAddedOrUpdated),l.getWsListener().unregisterListener(d.APP_REMOVED,this.handleAppRemoved),l.getWsListener().unregisterListener(d.APP_STATUS_CHANGE,this.handleAppStatusChange)})),p.apps.onRendered((function(){c.afterFlush((function(){f.setFlex("adminFlex"),f.openFlex()}))})),p.apps.helpers({isDevelopmentModeEnabled:function(){return!0===u.get("Apps_Framework_Development_Mode")},isLoading:function(){return p.instance().state.get("isLoading")},handleTableScroll:function(){var e,t=p.instance().state;if(!t.get("isLoading")&&!t.get("wasEndReached"))return function(e){var n,r,a,s;if(e.offsetHeight+e.scrollTop>=e.scrollHeight-100)return t.set("page",t.get("page")+1)}},handleTableResize:function(){var e,t=p.instance().state;return function(){var e=this.$(".table-scroll");t.set("itemsPerPage",Math.ceil(e.height()/40+5))}},handleTableSort:function(){var e,t=p.instance().state;return function(e){t.set({page:0,wasEndReached:!1}),t.get("sortedColumn")!==e?t.set({sortedColumn:e,isAscendingOrder:!0}):t.set("isAscendingOrder",!t.get("isAscendingOrder"))}},isSortingBy:function(e){return p.instance().state.get("sortedColumn")===e},sortIcon:function(e){var t,n=p.instance().state;return e===n.get("sortedColumn")&&n.get("isAscendingOrder")?"sort-down":"sort-up"},apps:function(){var e,t=p.instance().state,n=t.get("apps"),r=t.get("searchText").toLocaleLowerCase(),a=t.get("sortedColumn"),s,i=t.get("isAscendingOrder")?1:-1;return n.filter((function(e){var t;return e.name.toLocaleLowerCase().includes(r)})).sort((function(e,t){var n=e[a],r=t[a];return i*String(n).localeCompare(String(r))}))},appButtonProps:g,appStatusSpanProps:h}),p.apps.events({"click .js-marketplace":function(){i.go("marketplace")},"click .js-upload":function(){i.go("app-install")},"submit .js-search-form":function(e){return e.stopPropagation(),!1},"input .js-search":function(e,t){t.state.set("searchText",e.currentTarget.value)},"click .js-manage":function(e,t){e.stopPropagation();var n=e.currentTarget,r=t.state.get("apps").find((function(e){var t;return e.id===n.dataset.id})),a=r.id,s=r.version;i.go("app-manage",{appId:a},{version:s})},"click .js-install, click .js-update":function(){function e(e,t){var n,r,s,i;return a.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return e.preventDefault(),e.stopPropagation(),o.next=4,a.awrap(v());case 4:if(o.sent){o.next=6;break}return o.abrupt("return");case 6:return n=e.currentTarget,r=t.state.get("apps").find((function(e){var t;return e.id===n.dataset.id})),t.startAppWorking(r.id),o.prev=9,o.next=12,a.awrap(l.installApp(r.id,r.marketplaceVersion));case 12:s=o.sent,i=s.status,P(r.name,i),o.next=20;break;case 17:o.prev=17,o.t0=o.catch(9),A(o.t0);case 20:return o.prev=20,t.stopAppWorking(r.id),o.finish(20);case 23:case"end":return o.stop()}}return o}(),null,null,[[9,17,20,23]])}return e}(),"click .js-purchase":function(){function e(e,t){var n,r;return a.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return e.preventDefault(),e.stopPropagation(),s.next=4,a.awrap(v());case 4:if(s.sent){s.next=6;break}return s.abrupt("return");case 6:return n=e.currentTarget,r=t.state.get("apps").find((function(e){var t;return e.id===n.dataset.id})),t.startAppWorking(r.id),s.next=11,a.awrap(k(r,function(){function e(){var e,n;return a.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,a.awrap(l.installApp(r.id,r.marketplaceVersion));case 3:e=s.sent,n=e.status,P(r.name,n),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),A(s.t0);case 11:return s.prev=11,t.stopAppWorking(r.id),s.finish(11);case 14:case"end":return s.stop()}}return s}(),null,null,[[0,8,11,14]])}return e}(),t.stopAppWorking.bind(t,r.id)));case 11:case"end":return s.stop()}}return s}())}return e}(),"click .js-menu":function(e,t){e.stopPropagation();var n=e.currentTarget,r=t.state.get("apps").find((function(e){var t;return e.id===n.dataset.id}));m(r,n,t)}})}

