function module(e,t,n){var i,s,o,a,c,r,l,u,g,h,v;n.link("@babel/runtime/regenerator",{default:function(e){i=e}},0),n.link("meteor/meteor",{Meteor:function(e){s=e}},0),n.link("meteor/reactive-var",{ReactiveVar:function(e){o=e}},1),n.link("meteor/templating",{Template:function(e){a=e}},2),n.link("underscore",{default:function(e){c=e}},3),n.link("underscore.string",{default:function(e){r=e}},4),n.link("toastr",{default:function(e){l=e}},5),n.link("../../../../../ui-utils",{modal:function(e){u=e}},6),n.link("../../../../../utils",{t:function(e){g=e},handleError:function(e){h=e}},7),n.link("./livechatIntegrationWebhook.html"),n.link("../../../../../utils/client",{APIClient:function(e){v=e}},8);var k=function(e,t){return e.find((function(e){return e._id===t}))};a.livechatIntegrationWebhook.helpers({webhookUrl:function(){var e=k(a.instance().settings.get(),"Livechat_webhookUrl");return e&&e.value},secretToken:function(){var e=k(a.instance().settings.get(),"Livechat_secret_token");return e&&e.value},disableTest:function(){return a.instance().disableTest.get()},sendOnCloseChecked:function(){var e=k(a.instance().settings.get(),"Livechat_webhook_on_close");return e&&e.value},sendOnOfflineChecked:function(){var e=k(a.instance().settings.get(),"Livechat_webhook_on_offline_msg");return e&&e.value},sendOnVisitorMessageChecked:function(){var e=k(a.instance().settings.get(),"Livechat_webhook_on_visitor_message");return e&&e.value},sendOnAgentMessageChecked:function(){var e=k(a.instance().settings.get(),"Livechat_webhook_on_agent_message");return e&&e.value}}),a.livechatIntegrationWebhook.onCreated(function(){function e(){var e=this,t,n;return i.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return this.disableTest=new o(!0),this.settings=new o([]),this.autorun((function(){var t=k(e.settings.get(),"Livechat_webhookUrl");e.disableTest.set(!t||c.isEmpty(t.value))})),s.next=5,i.awrap(v.v1.get("livechat/integrations.settings"));case 5:t=s.sent,n=t.settings,this.settings.set(n);case 8:case"end":return s.stop()}}return s}(),null,this)}return e}()),a.livechatIntegrationWebhook.events({"change #webhookUrl, blur #webhookUrl":function(e,t){var n=k(t.settings.get(),"Livechat_webhookUrl");t.disableTest.set(!n||e.currentTarget.value!==n.value)},"click .test":function(e,t){t.disableTest.get()||s.call("livechat:webhookTest",(function(e){if(e)return h(e);u.open({title:g("It_works"),type:"success",timer:2e3})}))},"click .reset-settings":function(e,t){e.preventDefault();var n=k(t.settings.get(),"Livechat_webhookUrl"),i=k(t.settings.get(),"Livechat_secret_token"),s=k(t.settings.get(),"Livechat_webhook_on_close"),o=k(t.settings.get(),"Livechat_webhook_on_offline_msg"),a=k(t.settings.get(),"Livechat_webhook_on_visitor_message"),r=k(t.settings.get(),"Livechat_webhook_on_agent_message");t.$("#webhookUrl").val(n&&n.value),t.$("#secretToken").val(i&&i.value),t.$("#sendOnClose").get(0).checked=s&&s.value,t.$("#sendOnOffline").get(0).checked=o&&o.value,t.$("#sendOnVisitorMessage").get(0).checked=a&&a.value,t.$("#sendOnAgentMessage").get(0).checked=r&&r.value,t.disableTest.set(!n||c.isEmpty(n.value))},"submit .rocket-form":function(e,t){e.preventDefault();var n={Livechat_webhookUrl:r.trim(t.$("#webhookUrl").val()),Livechat_secret_token:r.trim(t.$("#secretToken").val()),Livechat_webhook_on_close:t.$("#sendOnClose").get(0).checked,Livechat_webhook_on_offline_msg:t.$("#sendOnOffline").get(0).checked,Livechat_webhook_on_visitor_message:t.$("#sendOnVisitorMessage").get(0).checked,Livechat_webhook_on_agent_message:t.$("#sendOnAgentMessage").get(0).checked};s.call("livechat:saveIntegration",n,(function(e){if(e)return h(e);var i=t.settings.get().map((function(e){return e.value=n[e._id],e}));t.settings.set(i),l.success(g("Saved"))}))}})}

