function module(t,n,e){var i,r,o,a,s,c,u,l,d,f,g,h,p,m,k,y,v,_,b,x;e.link("@babel/runtime/helpers/typeof",{default:function(t){i=t}},0),e.link("@babel/runtime/regenerator",{default:function(t){r=t}},1),e.link("@babel/runtime/helpers/objectSpread2",{default:function(t){o=t}},2),e.link("meteor/meteor",{Meteor:function(t){a=t}},0),e.link("meteor/reactive-var",{ReactiveVar:function(t){s=t}},1),e.link("meteor/kadira:flow-router",{FlowRouter:function(t){c=t}},2),e.link("meteor/templating",{Template:function(t){u=t}},3),e.link("meteor/rocketchat:tap-i18n",{TAPi18n:function(t){l=t}},4),e.link("meteor/tracker",{Tracker:function(t){d=t}},5),e.link("underscore",{default:function(t){f=t}},6),e.link("highlight.js",{default:function(t){g=t}},7),e.link("moment",{default:function(t){h=t}},8),e.link("toastr",{default:function(t){p=t}},9),e.link("../../../utils",{handleError:function(t){m=t}},10),e.link("../../../authorization",{hasAtLeastOnePermission:function(t){k=t}},11),e.link("../../lib/rocketchat",{integrations:function(t){y=t}},12),e.link("../../../ui-utils/client",{SideNav:function(t){v=t}},13),e.link("../../../utils/client",{APIClient:function(t){_=t}},14),e.link("../getIntegration",{getIntegration:function(t){b=t}},15),e.link("../streamer",{integrationHistoryStreamer:function(t){x=t}},16);var C=25;u.integrationsOutgoingHistory.onCreated(function(){function t(){var t=this,n,e;return r.async(function(){function i(i){for(;;)switch(i.prev=i.next){case 0:if(n=u.instance().data.params?u.instance().data.params():void 0,this.isLoading=new s(!1),this.history=new s([]),this.offset=new s(0),this.total=new s(0),!n||!n.id){i.next=16;break}return x.on(n.id,(function(n){var e=n.type,i=n.id,r=n.diff,a=n.data,s=t.history.get();if("inserted"!==e){if("updated"===e){var c=s.find((function(t){var n;return t._id===i}));return Object.assign(c,r),void t.history.set(s)}"removed"===e&&t.history.set([])}else t.history.set([o({},a)].concat(s))})),i.next=9,r.awrap(b(n.id,a.userId()));case 9:if(e=i.sent){i.next=13;break}return p.error(l.__("No_integration_found")),i.abrupt("return",c.go("admin-integrations"));case 13:this.autorun(function(){function n(){var n,i,o;return r.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:return t.isLoading.set(!0),a.next=3,r.awrap(_.v1.get("integrations.history?id="+e._id+"&count="+C+"&offset="+t.offset.get()));case 3:n=a.sent,i=n.history,o=n.total,t.history.set(t.history.get().concat(i)),t.total.set(o),t.isLoading.set(!1);case 9:case"end":return a.stop()}}return a}())}return n}()),i.next=18;break;case 16:p.error(l.__("No_integration_found")),c.go("admin-integrations");case 18:case"end":return i.stop()}}return i}(),null,this)}return t}()),u.integrationsOutgoingHistory.helpers({hasPermission:function(){return k(["manage-outgoing-integrations","manage-own-outgoing-integrations"])},isLoading:function(){return u.instance().isLoading.get()},histories:function(){return u.instance().history.get().sort((function(t,n){return+t._updatedAt<+n._updatedAt?1:+t._updatedAt>+n._updatedAt?-1:0}))},hasProperty:function(t,n){return void 0!==t[n]||null!=t[n]},iconClass:function(t){return void 0!==t.error&&t.error?"icon-cancel-circled error-color":t.finished?"icon-ok-circled success-color":"icon-help-circled"},statusI18n:function(t){return void 0!==t&&t?l.__("Failure"):l.__("Success")},formatDate:function(t){return h(t).format("L LTS")},formatDateDetail:function(t){return h(t).format("L HH:mm:ss:SSSS")},eventTypei18n:function(t){return l.__(y.outgoingEvents[t].label)},jsonStringify:function(t){return t?"object"===i(t)?g.highlight("json",JSON.stringify(t,null,2)).value:g.highlight("json",t).value:""},integrationId:function(){return this.params&&this.params()&&this.params().id}}),u.integrationsOutgoingHistory.events({"click .expand":function(t){$(t.currentTarget).closest(".section").removeClass("section-collapsed"),$(t.currentTarget).closest("button").removeClass("expand").addClass("collapse").find("span").text(l.__("Collapse")),$(".CodeMirror").each((function(t,n){return n.CodeMirror.refresh()}))},"click .collapse":function(t){$(t.currentTarget).closest(".section").addClass("section-collapsed"),$(t.currentTarget).closest("button").addClass("expand").removeClass("collapse").find("span").text(l.__("Expand"))},"click .replay":function(t,n){if(n&&n.data&&n.data.params&&n.data.params().id){var e=$(t.currentTarget).attr("data-history-id");a.call("replayOutgoingIntegration",{integrationId:n.data.params().id,historyId:e},(function(t){t&&m(t)}))}},"click .clear-history":function(t,n){n&&n.data&&n.data.params&&n.data.params().id&&a.call("clearIntegrationHistory",n.data.params().id,(function(t){t?m(t):(p.success(l.__("Integration_History_Cleared")),n.history.set([]))}))},"scroll .content":f.throttle((function(t,n){var e=n.history.get();t.target.scrollTop>=t.target.scrollHeight-t.target.clientHeight&&n.total.get()>e.length&&n.offset.set(n.offset.get()+C)}),200)}),u.integrationsOutgoingHistory.onRendered((function(){d.afterFlush((function(){v.setFlex("adminFlex"),v.openFlex()}))}))}

