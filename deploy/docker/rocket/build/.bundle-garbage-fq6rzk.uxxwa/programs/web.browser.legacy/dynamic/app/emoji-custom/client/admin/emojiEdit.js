function module(e,i,n){var t,a,o,l,r,s,u;n.link("meteor/meteor",{Meteor:function(e){t=e}},0),n.link("meteor/templating",{Template:function(e){a=e}},1),n.link("meteor/rocketchat:tap-i18n",{TAPi18n:function(e){o=e}},2),n.link("toastr",{default:function(e){l=e}},3),n.link("underscore.string",{default:function(e){r=e}},4),n.link("../../../utils",{t:function(e){s=e},handleError:function(e){u=e}},5),a.emojiEdit.helpers({emoji:function(){return a.instance().emoji},name:function(){return this.name||this._id}}),a.emojiEdit.events({"click .cancel":function(e,i){e.stopPropagation(),e.preventDefault(),delete a.instance().emojiFile,i.cancel(i.find("form"))},"submit form":function(e,i){e.stopPropagation(),e.preventDefault(),i.save(e.currentTarget)},"change input[type=file]":function(e){var i=null!=e.originalEvent?e.originalEvent:e,n=i.target.files;for(var t in null!=n&&0!==n.length||(n=null!=i.dataTransfer&&null!=i.dataTransfer.files?i.dataTransfer.files:[]),meteorBabelHelpers.sanitizeForInObject(n))n.hasOwnProperty(t)&&(a.instance().emojiFile=n[t])}}),a.emojiEdit.onCreated((function(){var e=this;null!=this.data?this.emoji=this.data.emoji:this.emoji=void 0,this.tabBar=a.currentData().tabBar,this.onSuccess=a.currentData().onSuccess,this.cancel=function(i,n){i.reset(),e.tabBar.close(),e.emoji&&e.data.back(n)},this.getEmojiData=function(){var i={};return null!=e.emoji&&(i._id=e.emoji._id,i.previousName=e.emoji.name,i.extension=e.emoji.extension,i.previousExtension=e.emoji.extension),i.name=r.trim(e.$("#name").val()),i.aliases=r.trim(e.$("#aliases").val()),i.newFile=!1,i},this.validate=function(){var i=e.getEmojiData(),n=[];i.name||n.push("Name"),i._id||e.emojiFile||n.push("Image");for(var t=0,a=n;t<a.length;t++){var r=a[t];l.error(o.__("error-the-field-is-required",{field:o.__(r)}))}return e.emojiFile&&(/image\/.+/.test(e.emojiFile.type)||(n.push("FileType"),l.error(o.__("error-invalid-file-type")))),0===n.length},this.save=function(i){if(e.validate()){var n=e.getEmojiData();e.emojiFile&&(n.newFile=!0,n.extension=e.emojiFile.name.split(".").pop()),t.call("insertOrUpdateEmoji",n,(function(a,r){if(r){if(e.emojiFile){l.info(o.__("Uploading_file"));var c=new FileReader;c.readAsBinaryString(e.emojiFile),c.onloadend=function(){t.call("uploadEmojiCustom",c.result,e.emojiFile.type,n,(function(e){null!=e&&(u(e),console.log(e))})),delete e.emojiFile,l.success(o.__("File_uploaded"))}}n._id?l.success(s("Custom_Emoji_Updated_Successfully")):l.success(s("Custom_Emoji_Added_Successfully")),e.onSuccess(),e.cancel(i,n.name)}a&&u(a)}))}}}))}

