function module(e,n,t){var r,a,i,o,c,l,s,u,m,d,f,g,h,p,v,_,k,x;t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("meteor/meteor",{Meteor:function(e){a=e}},0),t.link("meteor/reactive-var",{ReactiveVar:function(e){i=e}},1),t.link("meteor/kadira:flow-router",{FlowRouter:function(e){o=e}},2),t.link("meteor/templating",{Template:function(e){c=e}},3),t.link("meteor/rocketchat:tap-i18n",{TAPi18n:function(e){l=e}},4),t.link("meteor/tracker",{Tracker:function(e){s=e}},5),t.link("highlight.js",{default:function(e){u=e}},6),t.link("toastr",{default:function(e){m=e}},7),t.link("./messageExample",{exampleMsg:function(e){d=e},exampleSettings:function(e){f=e},exampleUser:function(e){g=e}},8),t.link("../../../authorization",{hasAtLeastOnePermission:function(e){h=e}},9),t.link("../../../ui-utils/client",{modal:function(e){p=e},SideNav:function(e){v=e}},10),t.link("../../../utils",{t:function(e){_=e},handleError:function(e){k=e}},11),t.link("../getIntegration",{getIntegration:function(e){x=e}},12),c.integrationsIncoming.onCreated(function(){function e(){var e,n;return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:if(e=c.instance().data.params?c.instance().data.params():void 0,this.integration=new i({}),this.record=new i({username:"rocket.cat"}),!e||!e.id){t.next=8;break}return t.next=6,r.awrap(x(e.id,a.userId()));case 6:(n=t.sent)&&this.integration.set(n);case 8:case"end":return t.stop()}}return t}(),null,this)}return e}()),c.integrationsIncoming.helpers({exampleMsg:d,exampleUser:g,exampleSettings:f,hasPermission:function(){return h(["manage-incoming-integrations","manage-own-incoming-integrations"])},canDelete:function(){return this.params&&this.params()&&void 0!==this.params().id},data:function(){var e=c.instance().integration.get();if(e){var n=e._id+"/"+e.token;return e.url=a.absoluteUrl("hooks/"+n),e.completeToken=n,e.hasScriptError=e.scriptEnabled&&e.scriptError,c.instance().record.set(e),e}return c.instance().record.curValue},exampleJson:function(){var e=c.instance().record.get(),n={username:e.alias,icon_emoji:e.emoji,icon_url:e.avatar,text:"Example message",attachments:[{title:"Rocket.Chat",title_link:"https://rocket.chat",text:"Rocket.Chat, the best open source chat",image_url:"/images/integration-attachment-example.png",color:"#764FA5"}]},t=[null,""];return Object.keys(n).forEach((function(e){t.includes(n[e])&&delete n[e]})),u.highlight("json",JSON.stringify(n,null,2)).value},curl:function(){var e=c.instance().record.get();if(e.url){var n={username:e.alias,icon_emoji:e.emoji,icon_url:e.avatar,text:"Example message",attachments:[{title:"Rocket.Chat",title_link:"https://rocket.chat",text:"Rocket.Chat, the best open source chat",image_url:"/images/integration-attachment-example.png",color:"#764FA5"}]},t=[null,""];return Object.keys(n).forEach((function(e){t.includes(n[e])&&delete n[e]})),"curl -X POST -H 'Content-Type: application/json' --data '"+JSON.stringify(n)+"' "+e.url}},editorOptions:function(){return{lineNumbers:!0,mode:"javascript",gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],foldGutter:!0,matchBrackets:!0,autoCloseBrackets:!0,matchTags:!0,showTrailingSpace:!0,highlightSelectionMatches:!0}}}),c.integrationsIncoming.events({"blur input":function(e,n){var t=n.record.curValue||{};t.name=$("[name=name]").val().trim(),t.alias=$("[name=alias]").val().trim(),t.emoji=$("[name=emoji]").val().trim(),t.avatar=$("[name=avatar]").val().trim(),t.channel=$("[name=channel]").val().trim(),t.username=$("[name=username]").val().trim(),n.record.set(t)},"click .rc-header__section-button > .delete":function(){var e=c.instance().data.params();p.open({title:_("Are_you_sure"),text:_("You_will_not_be_able_to_recover"),type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:_("Yes_delete_it"),cancelButtonText:_("Cancel"),closeOnConfirm:!1,html:!1},(function(){a.call("deleteIncomingIntegration",e.id,(function(e){if(e)return k(e);p.open({title:_("Deleted"),text:_("Your_entry_has_been_deleted"),type:"success",timer:1e3,showConfirmButton:!1}),o.go("admin-integrations")}))}))},"click .button-fullscreen":function(){var e=$(".code-mirror-box");e.addClass("code-mirror-box-fullscreen content-background-color"),e.find(".CodeMirror")[0].CodeMirror.refresh()},"click .button-restore":function(){var e=$(".code-mirror-box");e.removeClass("code-mirror-box-fullscreen content-background-color"),e.find(".CodeMirror")[0].CodeMirror.refresh()},"click .rc-header__section-button > .save":function(){var e=$("[name=enabled]:checked").val().trim(),n=$("[name=name]").val().trim(),t=$("[name=alias]").val().trim(),r=$("[name=emoji]").val().trim(),i=$("[name=avatar]").val().trim(),s=$("[name=channel]").val().trim(),u=$("[name=username]").val().trim(),d=$("[name=scriptEnabled]:checked").val().trim(),f=$("[name=script]").val().trim();if(""===s)return m.error(l.__("The_channel_name_is_required"));if(""===u)return m.error(l.__("The_username_is_required"));var g={enabled:"1"===e,channel:s,username:u,alias:""!==t?t:void 0,emoji:""!==r?r:void 0,avatar:""!==i?i:void 0,name:""!==n?n:void 0,script:""!==f?f:void 0,scriptEnabled:"1"===d},h=c.instance().data.params?c.instance().data.params():void 0;h&&h.id?a.call("updateIncomingIntegration",h.id,g,(function(e){if(e)return k(e);m.success(l.__("Integration_updated"))})):a.call("addIncomingIntegration",g,(function(e,n){if(e)return k(e);m.success(l.__("Integration_added")),o.go("admin-integrations-incoming",{id:n._id})}))}}),c.integrationsIncoming.onRendered((function(){s.afterFlush((function(){v.setFlex("adminFlex"),v.openFlex()}))}))}

