function module(e,t,s){let n,i,o,a,c,l,g,r,h,v;s.link("meteor/meteor",{Meteor(e){n=e}},0),s.link("meteor/reactive-var",{ReactiveVar(e){i=e}},1),s.link("meteor/templating",{Template(e){o=e}},2),s.link("underscore",{default(e){a=e}},3),s.link("underscore.string",{default(e){c=e}},4),s.link("toastr",{default(e){l=e}},5),s.link("../../../../../ui-utils",{modal(e){g=e}},6),s.link("../../../../../utils",{t(e){r=e},handleError(e){h=e}},7),s.link("./livechatIntegrationWebhook.html"),s.link("../../../../../utils/client",{APIClient(e){v=e}},8);const k=(e,t)=>e.find(e=>e._id===t);o.livechatIntegrationWebhook.helpers({webhookUrl(){const e=k(o.instance().settings.get(),"Livechat_webhookUrl");return e&&e.value},secretToken(){const e=k(o.instance().settings.get(),"Livechat_secret_token");return e&&e.value},disableTest:()=>o.instance().disableTest.get(),sendOnCloseChecked(){const e=k(o.instance().settings.get(),"Livechat_webhook_on_close");return e&&e.value},sendOnOfflineChecked(){const e=k(o.instance().settings.get(),"Livechat_webhook_on_offline_msg");return e&&e.value},sendOnVisitorMessageChecked(){const e=k(o.instance().settings.get(),"Livechat_webhook_on_visitor_message");return e&&e.value},sendOnAgentMessageChecked(){const e=k(o.instance().settings.get(),"Livechat_webhook_on_agent_message");return e&&e.value}}),o.livechatIntegrationWebhook.onCreated((async function(){this.disableTest=new i(!0),this.settings=new i([]),this.autorun(()=>{const e=k(this.settings.get(),"Livechat_webhookUrl");this.disableTest.set(!e||a.isEmpty(e.value))});const{settings:e}=await v.v1.get("livechat/integrations.settings");this.settings.set(e)})),o.livechatIntegrationWebhook.events({"change #webhookUrl, blur #webhookUrl"(e,t){const s=k(t.settings.get(),"Livechat_webhookUrl");t.disableTest.set(!s||e.currentTarget.value!==s.value)},"click .test"(e,t){t.disableTest.get()||n.call("livechat:webhookTest",e=>{if(e)return h(e);g.open({title:r("It_works"),type:"success",timer:2e3})})},"click .reset-settings"(e,t){e.preventDefault();const s=k(t.settings.get(),"Livechat_webhookUrl"),n=k(t.settings.get(),"Livechat_secret_token"),i=k(t.settings.get(),"Livechat_webhook_on_close"),o=k(t.settings.get(),"Livechat_webhook_on_offline_msg"),c=k(t.settings.get(),"Livechat_webhook_on_visitor_message"),l=k(t.settings.get(),"Livechat_webhook_on_agent_message");t.$("#webhookUrl").val(s&&s.value),t.$("#secretToken").val(n&&n.value),t.$("#sendOnClose").get(0).checked=i&&i.value,t.$("#sendOnOffline").get(0).checked=o&&o.value,t.$("#sendOnVisitorMessage").get(0).checked=c&&c.value,t.$("#sendOnAgentMessage").get(0).checked=l&&l.value,t.disableTest.set(!s||a.isEmpty(s.value))},"submit .rocket-form"(e,t){e.preventDefault();const s={Livechat_webhookUrl:c.trim(t.$("#webhookUrl").val()),Livechat_secret_token:c.trim(t.$("#secretToken").val()),Livechat_webhook_on_close:t.$("#sendOnClose").get(0).checked,Livechat_webhook_on_offline_msg:t.$("#sendOnOffline").get(0).checked,Livechat_webhook_on_visitor_message:t.$("#sendOnVisitorMessage").get(0).checked,Livechat_webhook_on_agent_message:t.$("#sendOnAgentMessage").get(0).checked};n.call("livechat:saveIntegration",s,e=>{if(e)return h(e);const n=t.settings.get().map(e=>(e.value=s[e._id],e));t.settings.set(n),l.success(r("Saved"))})}})}

