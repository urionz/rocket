function module(e,t,n){let a,r,i,o,c,s,l,m,d,u,g,h,p,_,k,v,f;n.link("meteor/meteor",{Meteor(e){a=e}},0),n.link("meteor/reactive-var",{ReactiveVar(e){r=e}},1),n.link("meteor/kadira:flow-router",{FlowRouter(e){i=e}},2),n.link("meteor/templating",{Template(e){o=e}},3),n.link("meteor/rocketchat:tap-i18n",{TAPi18n(e){c=e}},4),n.link("meteor/tracker",{Tracker(e){s=e}},5),n.link("highlight.js",{default(e){l=e}},6),n.link("toastr",{default(e){m=e}},7),n.link("./messageExample",{exampleMsg(e){d=e},exampleSettings(e){u=e},exampleUser(e){g=e}},8),n.link("../../../authorization",{hasAtLeastOnePermission(e){h=e}},9),n.link("../../../ui-utils/client",{modal(e){p=e},SideNav(e){_=e}},10),n.link("../../../utils",{t(e){k=e},handleError(e){v=e}},11),n.link("../getIntegration",{getIntegration(e){f=e}},12),o.integrationsIncoming.onCreated((async function e(){const t=o.instance().data.params?o.instance().data.params():void 0;if(this.integration=new r({}),this.record=new r({username:"rocket.cat"}),t&&t.id){const e=await f(t.id,a.userId());e&&this.integration.set(e)}})),o.integrationsIncoming.helpers({exampleMsg:d,exampleUser:g,exampleSettings:u,hasPermission:()=>h(["manage-incoming-integrations","manage-own-incoming-integrations"]),canDelete(){return this.params&&this.params()&&void 0!==this.params().id},data(){const e=o.instance().integration.get();if(e){const t="".concat(e._id,"/").concat(e.token);return e.url=a.absoluteUrl("hooks/".concat(t)),e.completeToken=t,e.hasScriptError=e.scriptEnabled&&e.scriptError,o.instance().record.set(e),e}return o.instance().record.curValue},exampleJson(){const e=o.instance().record.get(),t={username:e.alias,icon_emoji:e.emoji,icon_url:e.avatar,text:"Example message",attachments:[{title:"Rocket.Chat",title_link:"https://rocket.chat",text:"Rocket.Chat, the best open source chat",image_url:"/images/integration-attachment-example.png",color:"#764FA5"}]},n=[null,""];return Object.keys(t).forEach(e=>{n.includes(t[e])&&delete t[e]}),l.highlight("json",JSON.stringify(t,null,2)).value},curl(){const e=o.instance().record.get();if(!e.url)return;const t={username:e.alias,icon_emoji:e.emoji,icon_url:e.avatar,text:"Example message",attachments:[{title:"Rocket.Chat",title_link:"https://rocket.chat",text:"Rocket.Chat, the best open source chat",image_url:"/images/integration-attachment-example.png",color:"#764FA5"}]},n=[null,""];return Object.keys(t).forEach(e=>{n.includes(t[e])&&delete t[e]}),"curl -X POST -H 'Content-Type: application/json' --data '".concat(JSON.stringify(t),"' ").concat(e.url)},editorOptions:()=>({lineNumbers:!0,mode:"javascript",gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],foldGutter:!0,matchBrackets:!0,autoCloseBrackets:!0,matchTags:!0,showTrailingSpace:!0,highlightSelectionMatches:!0})}),o.integrationsIncoming.events({"blur input":(e,t)=>{const n=t.record.curValue||{};n.name=$("[name=name]").val().trim(),n.alias=$("[name=alias]").val().trim(),n.emoji=$("[name=emoji]").val().trim(),n.avatar=$("[name=avatar]").val().trim(),n.channel=$("[name=channel]").val().trim(),n.username=$("[name=username]").val().trim(),t.record.set(n)},"click .rc-header__section-button > .delete":()=>{const e=o.instance().data.params();p.open({title:k("Are_you_sure"),text:k("You_will_not_be_able_to_recover"),type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:k("Yes_delete_it"),cancelButtonText:k("Cancel"),closeOnConfirm:!1,html:!1},()=>{a.call("deleteIncomingIntegration",e.id,e=>{if(e)return v(e);p.open({title:k("Deleted"),text:k("Your_entry_has_been_deleted"),type:"success",timer:1e3,showConfirmButton:!1}),i.go("admin-integrations")})})},"click .button-fullscreen":()=>{const e=$(".code-mirror-box");e.addClass("code-mirror-box-fullscreen content-background-color"),e.find(".CodeMirror")[0].CodeMirror.refresh()},"click .button-restore":()=>{const e=$(".code-mirror-box");e.removeClass("code-mirror-box-fullscreen content-background-color"),e.find(".CodeMirror")[0].CodeMirror.refresh()},"click .rc-header__section-button > .save":()=>{const e=$("[name=enabled]:checked").val().trim(),t=$("[name=name]").val().trim(),n=$("[name=alias]").val().trim(),r=$("[name=emoji]").val().trim(),s=$("[name=avatar]").val().trim(),l=$("[name=channel]").val().trim(),d=$("[name=username]").val().trim(),u=$("[name=scriptEnabled]:checked").val().trim(),g=$("[name=script]").val().trim();if(""===l)return m.error(c.__("The_channel_name_is_required"));if(""===d)return m.error(c.__("The_username_is_required"));const h={enabled:"1"===e,channel:l,username:d,alias:""!==n?n:void 0,emoji:""!==r?r:void 0,avatar:""!==s?s:void 0,name:""!==t?t:void 0,script:""!==g?g:void 0,scriptEnabled:"1"===u},p=o.instance().data.params?o.instance().data.params():void 0;p&&p.id?a.call("updateIncomingIntegration",p.id,h,e=>{if(e)return v(e);m.success(c.__("Integration_updated"))}):a.call("addIncomingIntegration",h,(e,t)=>{if(e)return v(e);m.success(c.__("Integration_added")),i.go("admin-integrations-incoming",{id:t._id})})}}),o.integrationsIncoming.onRendered(()=>{s.afterFlush(()=>{_.setFlex("adminFlex"),_.openFlex()})})}

