{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:mongo-config/server/index.js"],"names":["tls","module","link","default","v","PassThrough","EmailTest","Mongo","DEFAULT_ECDH_CURVE","mongoOptionStr","process","env","MONGO_OPTIONS","mongoOptions","JSON","parse","setConnectionOptions","HTTP_FORWARDED_COUNT","NODE_ENV","TEST_MODE","stream","overrideOutputStream","on"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,GAAJ;AAAQC,MAAM,CAACC,IAAP,CAAY,KAAZ,EAAkB;AAACC,SAAO,CAACC,CAAD,EAAG;AAACJ,OAAG,GAACI,CAAJ;AAAM;;AAAlB,CAAlB,EAAsC,CAAtC;AAAyC,IAAIC,WAAJ;AAAgBJ,MAAM,CAACC,IAAP,CAAY,QAAZ,EAAqB;AAACG,aAAW,CAACD,CAAD,EAAG;AAACC,eAAW,GAACD,CAAZ;AAAc;;AAA9B,CAArB,EAAqD,CAArD;AAAwD,IAAIE,SAAJ;AAAcL,MAAM,CAACC,IAAP,CAAY,cAAZ,EAA2B;AAACI,WAAS,CAACF,CAAD,EAAG;AAACE,aAAS,GAACF,CAAV;AAAY;;AAA1B,CAA3B,EAAuD,CAAvD;AAA0D,IAAIG,KAAJ;AAAUN,MAAM,CAACC,IAAP,CAAY,cAAZ,EAA2B;AAACK,OAAK,CAACH,CAAD,EAAG;AAACG,SAAK,GAACH,CAAN;AAAQ;;AAAlB,CAA3B,EAA+C,CAA/C;AAM3M;AACA;AACA;AACA;AACA;AACAJ,GAAG,CAACQ,kBAAJ,GAAyB,MAAzB;AAEA,MAAMC,cAAc,GAAGC,OAAO,CAACC,GAAR,CAAYC,aAAnC;;AACA,IAAI,OAAOH,cAAP,KAA0B,WAA9B,EAA2C;AAC1C,QAAMI,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWN,cAAX,CAArB;AAEAF,OAAK,CAACS,oBAAN,CAA2BH,YAA3B;AACA;;AAEDH,OAAO,CAACC,GAAR,CAAYM,oBAAZ,GAAmCP,OAAO,CAACC,GAAR,CAAYM,oBAAZ,IAAoC,GAAvE,C,CAEA;;AACA,IAAIP,OAAO,CAACC,GAAR,CAAYO,QAAZ,KAAyB,aAAzB,IAA0CR,OAAO,CAACC,GAAR,CAAYQ,SAA1D,EAAqE;AACpE,QAAMC,MAAM,GAAG,IAAIf,WAAJ,EAAf;AACAC,WAAS,CAACe,oBAAV,CAA+BD,MAA/B;AACAA,QAAM,CAACE,EAAP,CAAU,MAAV,EAAkB,MAAM,CAAE,CAA1B;AACAF,QAAM,CAACE,EAAP,CAAU,KAAV,EAAiB,MAAM,CAAE,CAAzB;AACA,C","file":"/packages/rocketchat_mongo-config.js","sourcesContent":["import tls from 'tls';\nimport { PassThrough } from 'stream';\n\nimport { EmailTest } from 'meteor/email';\nimport { Mongo } from 'meteor/mongo';\n\n// FIX For TLS error see more here https://github.com/RocketChat/Rocket.Chat/issues/9316\n// TODO: Remove after NodeJS fix it, more information\n// https://github.com/nodejs/node/issues/16196\n// https://github.com/nodejs/node/pull/16853\n// This is fixed in Node 10, but this supports LTS versions\ntls.DEFAULT_ECDH_CURVE = 'auto';\n\nconst mongoOptionStr = process.env.MONGO_OPTIONS;\nif (typeof mongoOptionStr !== 'undefined') {\n\tconst mongoOptions = JSON.parse(mongoOptionStr);\n\n\tMongo.setConnectionOptions(mongoOptions);\n}\n\nprocess.env.HTTP_FORWARDED_COUNT = process.env.HTTP_FORWARDED_COUNT || '1';\n\n// Send emails to a \"fake\" stream instead of print them in console\nif (process.env.NODE_ENV !== 'development' || process.env.TEST_MODE) {\n\tconst stream = new PassThrough();\n\tEmailTest.overrideOutputStream(stream);\n\tstream.on('data', () => {});\n\tstream.on('end', () => {});\n}\n"]}