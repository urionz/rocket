function module(e,t,n){let i,r,a,o,l,s,c,m,d,p;n.link("meteor/meteor",{Meteor(e){i=e}},0),n.link("meteor/kadira:flow-router",{FlowRouter(e){r=e}},1),n.link("meteor/templating",{Template(e){a=e}},2),n.link("meteor/reactive-var",{ReactiveVar(e){o=e}},3),n.link("meteor/reactive-dict",{ReactiveDict(e){l=e}},4),n.link("underscore",{default(e){s=e}},5),n.link("../../../../ui-utils",{modal(e){c=e}},6),n.link("../../../../utils",{t(e){m=e},handleError(e){d=e}},7),n.link("./livechatDepartments.html"),n.link("../../../../utils/client",{APIClient(e){p=e}},8),a.livechatDepartments.helpers({departments:()=>a.instance().departments.get(),isLoading:()=>a.instance().state.get("loading"),isReady(){const e=a.instance();return e.ready&&e.ready.get()},onTableScroll(){const e=a.instance();return function(t){if(t.offsetHeight+t.scrollTop>=t.scrollHeight-100)return e.limit.set(e.limit.get()+50)}}});const u=300;a.livechatDepartments.events({"click .remove-department"(e,t){e.preventDefault(),e.stopPropagation(),c.open({title:m("Are_you_sure"),type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:m("Yes"),cancelButtonText:m("Cancel"),closeOnConfirm:!1,html:!1},()=>{i.call("livechat:removeDepartment",this._id,e=>{if(e)return d(e);t.departments.set(t.departments.curValue.filter(e=>e._id!==this._id)),c.open({title:m("Removed"),text:m("Department_removed"),type:"success",timer:1e3,showConfirmButton:!1})})})},"click .department-info"(e){e.preventDefault(),r.go("livechat-department-edit",{_id:this._id})},"keydown #departments-filter"(e){13===e.which&&(e.stopPropagation(),e.preventDefault())},"keyup #departments-filter":s.debounce((e,t)=>{e.stopPropagation(),e.preventDefault(),t.filter.set(e.currentTarget.value)},300)}),a.livechatDepartments.onCreated((function(){const e=this;this.limit=new o(50),this.filter=new o(""),this.state=new l({loading:!1}),this.ready=new o(!0),this.departments=new o([]),this.autorun((async function(){const t=e.limit.get(),n=e.filter.get();let i="livechat/department?count=".concat(t);n&&(i+="&text=".concat(encodeURIComponent(n)));const{departments:r}=await p.v1.get(i);e.departments.set(r),e.ready.set(!0)}))}))}

