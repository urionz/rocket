function module(t,e,n){var r,a,c,s,i,u,o,h;n.link("@babel/runtime/regenerator",{default:function(t){r=t}},0),n.link("meteor/templating",{Template:function(t){a=t}},0),n.link("moment",{default:function(t){c=t}},1),n.link("meteor/reactive-var",{ReactiveVar:function(t){s=t}},2),n.link("../../../lib/chartHandler",{drawLineChart:function(t){i=t},drawDoughnutChart:function(t){u=t},updateChart:function(t){o=t}},3),n.link("../../../../../utils/client",{APIClient:function(t){h=t}},4),n.link("./livechatRealTimeMonitoring.html");var l={},f,p={"lc-chats-chart":function(){return u(document.getElementById("lc-chats-chart"),"Chats",l["lc-chats-chart"],["Open","Queue","Closed"],[0,0,0])},"lc-agents-chart":function(){return u(document.getElementById("lc-agents-chart"),"Agents",l["lc-agents-chart"],["Available","Away","Busy","Offline"],[0,0,0,0])},"lc-chats-per-agent-chart":function(){return i(document.getElementById("lc-chats-per-agent-chart"),l["lc-chats-per-agent-chart"],["Open","Closed"],[],[[],[]],{legends:!0,anim:!0,smallTicks:!0})},"lc-chats-per-dept-chart":function(){return document.getElementById("lc-chats-per-dept-chart")?i(document.getElementById("lc-chats-per-dept-chart"),l["lc-chats-per-dept-chart"],["Open","Closed"],[],[[],[]],{legends:!0,anim:!0,smallTicks:!0}):null},"lc-reaction-response-times-chart":function(){for(var t=[],e=[],n,r=c().startOf("day");r.diff(c(),"hours")<0;r.add(1,"hours")){var a=r.format("H");t.push(c(a,["H"]).format("hA")+"-"+c((parseInt(a)+1)%24,["H"]).format("hA")),e.push(0)}return i(document.getElementById("lc-reaction-response-times-chart"),l["lc-reaction-response-times-chart"],["Avg_reaction_time","Longest_reaction_time","Avg_response_time","Longest_response_time"],t.slice(),[e.slice(),e.slice(),e.slice(),e.slice()],{legends:!0,anim:!0,smallTicks:!0})},"lc-chat-duration-chart":function(){for(var t=[],e=[],n,r=c().startOf("day");r.diff(c(),"hours")<0;r.add(1,"hours")){var a=r.format("H");t.push(c(a,["H"]).format("hA")+"-"+c((parseInt(a)+1)%24,["H"]).format("hA")),e.push(0)}return i(document.getElementById("lc-chat-duration-chart"),l["lc-chat-duration-chart"],["Avg_chat_duration","Longest_chat_duration"],t.slice(),[e.slice(),e.slice()],{legends:!0,anim:!0,smallTicks:!0})}},d=function(){function t(){return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.awrap(p["lc-chats-chart"]());case 2:return l["lc-chats-chart"]=t.sent,t.next=5,r.awrap(p["lc-agents-chart"]());case 5:return l["lc-agents-chart"]=t.sent,t.next=8,r.awrap(p["lc-chats-per-agent-chart"]());case 8:return l["lc-chats-per-agent-chart"]=t.sent,t.next=11,r.awrap(p["lc-chats-per-dept-chart"]());case 11:return l["lc-chats-per-dept-chart"]=t.sent,t.next=14,r.awrap(p["lc-reaction-response-times-chart"]());case 14:return l["lc-reaction-response-times-chart"]=t.sent,t.next=17,r.awrap(p["lc-chat-duration-chart"]());case 17:l["lc-chat-duration-chart"]=t.sent;case 18:case"end":return t.stop()}}return t}())}return t}(),v=function(){function t(t,e,n){return r.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:if(l[t]){a.next=4;break}return a.next=3,r.awrap(p[t]());case 3:l[t]=a.sent;case 4:return a.next=6,r.awrap(o(l[t],e,n));case 6:case"end":return a.stop()}}return a}())}return t}(),g,w=function(){var t=c(new Date);return{start:c(new Date(t.year(),t.month(),t.date(),0,0,0)).utc().format("YYYY-MM-DDTHH:mm:ss")+"Z",end:c(new Date(t.year(),t.month(),t.date(),23,59,59)).utc().format("YYYY-MM-DDTHH:mm:ss")+"Z"}},m=function(){function t(t){var e,n,a,c;return r.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return e=t.start,n=t.end,s.next=3,r.awrap(h.v1.get("livechat/analytics/dashboards/conversation-totalizers?start="+e+"&end="+n));case 3:return a=s.sent,c=a.totalizers,s.abrupt("return",c);case 6:case"end":return s.stop()}}return s}())}return t}(),y=function(){function t(t){return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:t&&Array.isArray(t)&&f.conversationsOverview.set(t);case 1:case"end":return e.stop()}}return e}())}return t}(),x=function(){function t(t){var e,n,a,c;return r.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return e=t.start,n=t.end,s.next=3,r.awrap(h.v1.get("livechat/analytics/dashboards/agents-productivity-totalizers?start="+e+"&end="+n));case 3:return a=s.sent,c=a.totalizers,s.abrupt("return",c);case 6:case"end":return s.stop()}}return s}())}return t}(),b=function(){function t(t){return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:t&&Array.isArray(t)&&f.agentsOverview.set(t);case 1:case"end":return e.stop()}}return e}())}return t}(),O=function(){function t(t){var e,n,a,c;return r.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return e=t.start,n=t.end,s.next=3,r.awrap(h.v1.get("livechat/analytics/dashboards/chats-totalizers?start="+e+"&end="+n));case 3:return a=s.sent,c=a.totalizers,s.abrupt("return",c);case 6:case"end":return s.stop()}}return s}())}return t}(),A=function(){function t(t){return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:t&&Array.isArray(t)&&f.chatsOverview.set(t);case 1:case"end":return e.stop()}}return e}())}return t}(),k=function(){function t(t){var e,n,a,c;return r.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return e=t.start,n=t.end,s.next=3,r.awrap(h.v1.get("livechat/analytics/dashboards/productivity-totalizers?start="+e+"&end="+n));case 3:return a=s.sent,c=a.totalizers,s.abrupt("return",c);case 6:case"end":return s.stop()}}return s}())}return t}(),D=function(){function t(t){return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:t&&Array.isArray(t)&&f.timingOverview.set(t);case 1:case"end":return e.stop()}}return e}())}return t}(),H=function(t){var e=t.start,n=t.end;return h.v1.get("livechat/analytics/dashboards/charts/chats?start="+e+"&end="+n)},I=function(){function t(t){var e,n,a;return r.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return e=t.open,n=t.closed,a=t.queued,c.next=3,r.awrap(v("lc-chats-chart","Open",[e]));case 3:return c.next=5,r.awrap(v("lc-chats-chart","Closed",[n]));case 5:return c.next=7,r.awrap(v("lc-chats-chart","Queue",[a]));case 7:case"end":return c.stop()}}return c}())}return t}(),T=function(){function t(t){var e,n,a;return r.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return e=t.start,n=t.end,c.next=3,r.awrap(h.v1.get("livechat/analytics/dashboards/charts/chats-per-agent?start="+e+"&end="+n));case 3:return delete(a=c.sent).success,c.abrupt("return",a);case 6:case"end":return c.stop()}}return c}())}return t}(),_=function(t){Object.keys(t).forEach((function(e){return v("lc-chats-per-agent-chart",e,[t[e].open,t[e].closed])}))},C=function(){return h.v1.get("livechat/analytics/dashboards/charts/agents-status")},M=function(){function t(t){return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.awrap(v("lc-agents-chart","Offline",[t.offline]));case 4:return e.next=6,r.awrap(v("lc-agents-chart","Available",[t.available]));case 6:return e.next=8,r.awrap(v("lc-agents-chart","Away",[t.away]));case 8:return e.next=10,r.awrap(v("lc-agents-chart","Busy",[t.busy]));case 10:case"end":return e.stop()}}return e}())}return t}(),z=function(){function t(t){var e,n,a;return r.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return e=t.start,n=t.end,c.next=3,r.awrap(h.v1.get("livechat/analytics/dashboards/charts/chats-per-department?start="+e+"&end="+n));case 3:return delete(a=c.sent).success,c.abrupt("return",a);case 6:case"end":return c.stop()}}return c}())}return t}(),B=function(t){Object.keys(t).forEach((function(e){return v("lc-chats-per-dept-chart",e,[t[e].open,t[e].closed])}))},E=function(t){var e=t.start,n=t.end;return h.v1.get("livechat/analytics/dashboards/charts/timings?start="+e+"&end="+n)},L=function(){function t(t){var e,n;return r.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:return e=c(new Date).format("H"),n=c(e,["H"]).format("hA")+"-"+c((parseInt(e)+1)%24,["H"]).format("hA"),a.next=4,r.awrap(v("lc-reaction-response-times-chart",n,[t.reaction.avg,t.reaction.longest,t.response.avg,t.response.longest]));case 4:return a.next=6,r.awrap(v("lc-chat-duration-chart",n,[t.chatDuration.avg,t.chatDuration.longest]));case 6:case"end":return a.stop()}}return a}())}return t}(),R=function(){return 1e3*f.interval.get()};a.livechatRealTimeMonitoring.helpers({selected:function(t){return(t===f.analyticsOptions.get().value||t===f.chartOptions.get().value)&&"selected"},conversationsOverview:function(){return f.conversationsOverview.get()},timingOverview:function(){return f.timingOverview.get()},agentsOverview:function(){return f.agentsOverview.get()},chatsOverview:function(){return f.chatsOverview.get()},isLoading:function(){return a.instance().isLoading.get()}}),a.livechatRealTimeMonitoring.onCreated((function(){f=a.instance(),this.isLoading=new s(!1),this.conversationsOverview=new s,this.timingOverview=new s,this.chatsOverview=new s,this.agentsOverview=new s,this.conversationTotalizers=new s([]),this.interval=new s(5)})),a.livechatRealTimeMonitoring.onRendered(function(){function t(){var t=this;return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.awrap(d());case 2:return this.updateDashboard=function(){function t(){var t;return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return t=w(),e.t0=y,e.next=4,r.awrap(m(t));case 4:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=D,e.next=9,r.awrap(k(t));case 9:return e.t3=e.sent,(0,e.t2)(e.t3),e.t4=I,e.next=14,r.awrap(H(t));case 14:return e.t5=e.sent,(0,e.t4)(e.t5),e.t6=_,e.next=19,r.awrap(T(t));case 19:return e.t7=e.sent,(0,e.t6)(e.t7),e.t8=M,e.next=24,r.awrap(C());case 24:return e.t9=e.sent,(0,e.t8)(e.t9),e.t10=B,e.next=29,r.awrap(z(t));case 29:return e.t11=e.sent,(0,e.t10)(e.t11),e.t12=L,e.next=34,r.awrap(E(t));case 34:return e.t13=e.sent,(0,e.t12)(e.t13),e.t14=b,e.next=39,r.awrap(x(t));case 39:return e.t15=e.sent,(0,e.t14)(e.t15),e.t16=A,e.next=44,r.awrap(O(t));case 44:e.t17=e.sent,(0,e.t16)(e.t17);case 46:case"end":return e.stop()}}return e}())}return t}(),this.autorun((function(){g&&clearInterval(g),g=setInterval((function(){return t.updateDashboard()}),R())})),this.isLoading.set(!0),e.next=7,r.awrap(this.updateDashboard());case 7:this.isLoading.set(!1);case 8:case"end":return e.stop()}}return e}(),null,this)}return t}()),a.livechatRealTimeMonitoring.events({"change .js-interval":function(t,e){e.interval.set(t.target.value)}}),a.livechatRealTimeMonitoring.onDestroyed((function(){clearInterval(g)}))}

