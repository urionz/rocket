function module(e,r,t){"use strict";var n=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(e){var r=!1;return function(){if(!r){r=!0;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.apply(this,n)}}}function i(){}function a(e){return e.setHeader&&"function"==typeof e.abort}function l(e,r,t){if("function"==typeof r)return l(e,null,r);r||(r={}),t=o(t||i);var c=r.readable||!1!==r.readable&&e.readable,s=r.writable||!1!==r.writable&&e.writable,f=function r(){e.writable||d()},u=e._writableState&&e._writableState.finished,d=function r(){s=!1,u=!0,c||t.call(e)},b=e._readableState&&e._readableState.endEmitted,v=function r(){c=!1,b=!0,s||t.call(e)},m=function r(n){t.call(e,n)},w=function r(){var o;return c&&!b?(e._readableState&&e._readableState.ended||(o=new n),t.call(e,o)):s&&!u?(e._writableState&&e._writableState.ended||(o=new n),t.call(e,o)):void 0},_=function r(){e.req.on("finish",d)};return a(e)?(e.on("complete",d),e.on("abort",w),e.req?_():e.on("request",_)):s&&!e._writableState&&(e.on("end",f),e.on("close",f)),e.on("end",v),e.on("finish",d),!1!==r.error&&e.on("error",m),e.on("close",w),function(){e.removeListener("complete",d),e.removeListener("abort",w),e.removeListener("request",_),e.req&&e.req.removeListener("finish",d),e.removeListener("end",f),e.removeListener("close",f),e.removeListener("finish",d),e.removeListener("end",v),e.removeListener("error",m),e.removeListener("close",w)}}t.exports=l}

