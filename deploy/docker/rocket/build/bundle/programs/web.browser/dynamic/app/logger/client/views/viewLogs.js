function module(t,e,o){let s,i,n,l,r,a,c,d,h;o.link("underscore",{default(t){s=t}},0),o.link("meteor/meteor",{Meteor(t){i=t}},1),o.link("meteor/templating",{Template(t){n=t}},2),o.link("meteor/tracker",{Tracker(t){l=t}},3),o.link("../ansispan",{ansispan(t){r=t}},4),o.link("../viewLogs",{stdout(t){a=t}},5),o.link("../../../authorization",{hasAllPermission(t){c=t}},6),o.link("../../../ui-utils/client",{SideNav(t){d=t}},7),o.link("./viewLogs.html"),o.link("./viewLogs.css"),o.link("../../../utils/client",{APIClient(t){h=t}},8);const m=new i.Streamer("stdout");n.viewLogs.onCreated((async function(){const{queue:t}=await h.v1.get("stdout.queue");(t||[]).forEach(t=>a.insert(t)),m.on("stdout",t=>a.insert(t)),this.atBottom=!0})),n.viewLogs.onDestroyed(()=>{a.remove({}),m.removeListener("stdout")}),n.viewLogs.helpers({hasPermission:()=>c("view-logs"),logs:()=>a.find({},{sort:{ts:1}}),ansispan:r}),n.viewLogs.events({"click .new-logs"(t,e){e.atBottom=!0,e.sendToBottomIfNecessary()}}),n.viewLogs.onRendered((function(){l.afterFlush(()=>{d.setFlex("adminFlex"),d.openFlex()});const t=this.find(".js-terminal"),e=this.find(".js-new-logs");if(this.isAtBottom=o=>(null==o&&(o=0),t.scrollTop+o>=t.scrollHeight-t.clientHeight&&(e.className="new-logs not",!0)),this.sendToBottom=()=>{t.scrollTop=t.scrollHeight-t.clientHeight,e.className="new-logs not"},this.checkIfScrollIsAtBottom=()=>{this.atBottom=this.isAtBottom(100)},this.sendToBottomIfNecessary=()=>{!0===this.atBottom&&!0!==this.isAtBottom()?this.sendToBottom():!1===this.atBottom&&(e.className="new-logs")},this.sendToBottomIfNecessaryDebounced=s.debounce(this.sendToBottomIfNecessary,10),this.sendToBottomIfNecessary(),window.MutationObserver){const e=new MutationObserver(t=>{t.forEach(()=>this.sendToBottomIfNecessaryDebounced())});e.observe(t,{childList:!0})}else t.addEventListener("DOMSubtreeModified",()=>this.sendToBottomIfNecessaryDebounced());this.onWindowResize=()=>{i.defer(()=>this.sendToBottomIfNecessaryDebounced())},window.addEventListener("resize",this.onWindowResize),t.addEventListener("mousewheel",()=>{this.atBottom=!1,i.defer(()=>this.checkIfScrollIsAtBottom())}),t.addEventListener("wheel",()=>{this.atBottom=!1,i.defer(()=>this.checkIfScrollIsAtBottom())}),t.addEventListener("touchstart",()=>{this.atBottom=!1}),t.addEventListener("touchend",()=>{i.defer(()=>this.checkIfScrollIsAtBottom())}),t.addEventListener("scroll",()=>{this.atBottom=!1,i.defer(()=>this.checkIfScrollIsAtBottom())})}))}

