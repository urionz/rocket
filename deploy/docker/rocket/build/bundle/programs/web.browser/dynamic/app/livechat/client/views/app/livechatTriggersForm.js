function module(e,t,n){let i,a,r,s,c,o,g,l;n.link("meteor/meteor",{Meteor(e){i=e}},0),n.link("meteor/reactive-var",{ReactiveVar(e){a=e}},1),n.link("meteor/kadira:flow-router",{FlowRouter(e){r=e}},2),n.link("meteor/templating",{Template(e){s=e}},3),n.link("toastr",{default(e){c=e}},4),n.link("../../../../utils",{t(e){o=e},handleError(e){g=e}},5),n.link("./livechatTriggersForm.html"),n.link("../../../../utils/client",{APIClient(e){l=e}},6),s.livechatTriggersForm.helpers({name(){const e=s.instance().trigger.get();return e&&e.name},description(){const e=s.instance().trigger.get();return e&&e.description},enabled(){const e=s.instance().trigger.get();return e&&e.enabled},runOnce(){const e=s.instance().trigger.get();return e&&e.runOnce||!1},conditions(){const e=s.instance().trigger.get();return e?e.conditions:[]},actions(){const e=s.instance().trigger.get();return e?e.actions:[]}}),s.livechatTriggersForm.events({"submit #trigger-form"(e,t){e.preventDefault();const n=t.$("button.save"),a=n.html();n.html(o("Saving"));const s={_id:r.getParam("_id"),name:t.$("input[name=name]").val(),description:t.$("input[name=description]").val(),enabled:"1"===t.$("input[name=enabled]:checked").val(),runOnce:"1"===t.$("input[name=runOnce]:checked").val(),conditions:[],actions:[]};$(".each-condition").each((function(){s.conditions.push({name:$(".trigger-condition",this).val(),value:$(".".concat($(".trigger-condition",this).val(),"-value")).val()})})),$(".each-action").each((function(){if("send-message"===$(".trigger-action",this).val()){const e={sender:$("[name=send-message-sender]",this).val(),msg:$("[name=send-message-msg]",this).val()};"custom"===e.sender&&(e.name=$("[name=send-message-name]",this).val()),s.actions.push({name:$(".trigger-action",this).val(),params:e})}else s.actions.push({name:$(".trigger-action",this).val(),value:$(".".concat($(".trigger-action",this).val(),"-value")).val()})})),i.call("livechat:saveTrigger",s,(function(e){if(n.html(a),e)return g(e);r.go("livechat-triggers"),c.success(o("Saved"))}))},"click button.back"(e){e.preventDefault(),r.go("livechat-triggers")}}),s.livechatTriggersForm.onCreated((async function(){this.trigger=new a({});const e=r.getParam("_id");if(e){const{trigger:t}=await l.v1.get("livechat/triggers/".concat(e));this.trigger.set(t)}}))}

