function module(e,n){"use strict";var t=e("buffer").Buffer,i=e("stream").Transform,r=e("./binding"),o=e("util"),f=e("assert").ok,s=e("buffer").kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+s.toString(16)+" bytes";r.Z_MIN_WINDOWBITS=8,r.Z_MAX_WINDOWBITS=15,r.Z_DEFAULT_WINDOWBITS=15,r.Z_MIN_CHUNK=64,r.Z_MAX_CHUNK=1/0,r.Z_DEFAULT_CHUNK=16384,r.Z_MIN_MEMLEVEL=1,r.Z_MAX_MEMLEVEL=9,r.Z_DEFAULT_MEMLEVEL=8,r.Z_MIN_LEVEL=-1,r.Z_MAX_LEVEL=9,r.Z_DEFAULT_LEVEL=r.Z_DEFAULT_COMPRESSION;for(var _=Object.keys(r),a=0;a<_.length;a++){var u=_[a];u.match(/^Z/)&&Object.defineProperty(n,u,{enumerable:!0,value:r[u],writable:!1})}for(var h={Z_OK:r.Z_OK,Z_STREAM_END:r.Z_STREAM_END,Z_NEED_DICT:r.Z_NEED_DICT,Z_ERRNO:r.Z_ERRNO,Z_STREAM_ERROR:r.Z_STREAM_ERROR,Z_DATA_ERROR:r.Z_DATA_ERROR,Z_MEM_ERROR:r.Z_MEM_ERROR,Z_BUF_ERROR:r.Z_BUF_ERROR,Z_VERSION_ERROR:r.Z_VERSION_ERROR},c=Object.keys(h),E=0;E<c.length;E++){var d=c[E];h[h[d]]=d}function w(e,n,i){var r=[],o=0;function f(){for(var n;null!==(n=e.read());)r.push(n),o+=n.length;e.once("readable",f)}function _(n){e.removeListener("end",a),e.removeListener("readable",f),i(n)}function a(){var n,f=null;o>=s?f=new RangeError(l):n=t.concat(r,o),r=[],e.close(),i(f,n)}e.on("error",_),e.on("end",a),e.end(n),f()}function Z(e,n){if("string"==typeof n&&(n=t.from(n)),!t.isBuffer(n))throw new TypeError("Not a string or buffer");var i=e._finishFlushFlag;return e._processChunk(n,i)}function L(e){if(!(this instanceof L))return new L(e);F.call(this,e,r.DEFLATE)}function R(e){if(!(this instanceof R))return new R(e);F.call(this,e,r.INFLATE)}function v(e){if(!(this instanceof v))return new v(e);F.call(this,e,r.GZIP)}function p(e){if(!(this instanceof p))return new p(e);F.call(this,e,r.GUNZIP)}function I(e){if(!(this instanceof I))return new I(e);F.call(this,e,r.DEFLATERAW)}function g(e){if(!(this instanceof g))return new g(e);F.call(this,e,r.INFLATERAW)}function S(e){if(!(this instanceof S))return new S(e);F.call(this,e,r.UNZIP)}function y(e){return e===r.Z_NO_FLUSH||e===r.Z_PARTIAL_FLUSH||e===r.Z_SYNC_FLUSH||e===r.Z_FULL_FLUSH||e===r.Z_FINISH||e===r.Z_BLOCK}function F(e,o){var f=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||n.Z_DEFAULT_CHUNK,i.call(this,e),e.flush&&!y(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!y(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||r.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:r.Z_FINISH,e.chunkSize&&(e.chunkSize<n.Z_MIN_CHUNK||e.chunkSize>n.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<n.Z_MIN_WINDOWBITS||e.windowBits>n.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<n.Z_MIN_LEVEL||e.level>n.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<n.Z_MIN_MEMLEVEL||e.memLevel>n.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=n.Z_FILTERED&&e.strategy!=n.Z_HUFFMAN_ONLY&&e.strategy!=n.Z_RLE&&e.strategy!=n.Z_FIXED&&e.strategy!=n.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!t.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new r.Zlib(o);var s=this;this._hadError=!1,this._handle.onerror=function(e,t){b(s),s._hadError=!0;var i=new Error(e);i.errno=t,i.code=n.codes[t],s.emit("error",i)};var l=n.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(l=e.level);var _=n.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(_=e.strategy),this._handle.init(e.windowBits||n.Z_DEFAULT_WINDOWBITS,l,e.memLevel||n.Z_DEFAULT_MEMLEVEL,_,e.dictionary),this._buffer=t.allocUnsafe(this._chunkSize),this._offset=0,this._level=l,this._strategy=_,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!f._handle},configurable:!0,enumerable:!0})}function b(e,n){n&&process.nextTick(n),e._handle&&(e._handle.close(),e._handle=null)}function N(e){e.emit("close")}Object.defineProperty(n,"codes",{enumerable:!0,value:Object.freeze(h),writable:!1}),n.Deflate=L,n.Inflate=R,n.Gzip=v,n.Gunzip=p,n.DeflateRaw=I,n.InflateRaw=g,n.Unzip=S,n.createDeflate=function(e){return new L(e)},n.createInflate=function(e){return new R(e)},n.createDeflateRaw=function(e){return new I(e)},n.createInflateRaw=function(e){return new g(e)},n.createGzip=function(e){return new v(e)},n.createGunzip=function(e){return new p(e)},n.createUnzip=function(e){return new S(e)},n.deflate=function(e,n,t){return"function"==typeof n&&(t=n,n={}),w(new L(n),e,t)},n.deflateSync=function(e,n){return Z(new L(n),e)},n.gzip=function(e,n,t){return"function"==typeof n&&(t=n,n={}),w(new v(n),e,t)},n.gzipSync=function(e,n){return Z(new v(n),e)},n.deflateRaw=function(e,n,t){return"function"==typeof n&&(t=n,n={}),w(new I(n),e,t)},n.deflateRawSync=function(e,n){return Z(new I(n),e)},n.unzip=function(e,n,t){return"function"==typeof n&&(t=n,n={}),w(new S(n),e,t)},n.unzipSync=function(e,n){return Z(new S(n),e)},n.inflate=function(e,n,t){return"function"==typeof n&&(t=n,n={}),w(new R(n),e,t)},n.inflateSync=function(e,n){return Z(new R(n),e)},n.gunzip=function(e,n,t){return"function"==typeof n&&(t=n,n={}),w(new p(n),e,t)},n.gunzipSync=function(e,n){return Z(new p(n),e)},n.inflateRaw=function(e,n,t){return"function"==typeof n&&(t=n,n={}),w(new g(n),e,t)},n.inflateRawSync=function(e,n){return Z(new g(n),e)},o.inherits(F,i),F.prototype.params=function(e,t,i){if(e<n.Z_MIN_LEVEL||e>n.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=n.Z_FILTERED&&t!=n.Z_HUFFMAN_ONLY&&t!=n.Z_RLE&&t!=n.Z_FIXED&&t!=n.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var o=this;this.flush(r.Z_SYNC_FLUSH,(function(){f(o._handle,"zlib binding closed"),o._handle.params(e,t),o._hadError||(o._level=e,o._strategy=t,i&&i())}))}else process.nextTick(i)},F.prototype.reset=function(){return f(this._handle,"zlib binding closed"),this._handle.reset()},F.prototype._flush=function(e){this._transform(t.alloc(0),"",e)},F.prototype.flush=function(e,n){var i=this,o=this._writableState;("function"==typeof e||void 0===e&&!n)&&(n=e,e=r.Z_FULL_FLUSH),o.ended?n&&process.nextTick(n):o.ending?n&&this.once("end",n):o.needDrain?n&&this.once("drain",(function(){return i.flush(e,n)})):(this._flushFlag=e,this.write(t.alloc(0),"",n))},F.prototype.close=function(e){b(this,e),process.nextTick(N,this)},F.prototype._transform=function(e,n,i){var o,f=this._writableState,s,l=(f.ending||f.ended)&&(!e||f.length===e.length);return null===e||t.isBuffer(e)?this._handle?(l?o=this._finishFlushFlag:(o=this._flushFlag,e.length>=f.length&&(this._flushFlag=this._opts.flush||r.Z_NO_FLUSH)),void this._processChunk(e,o,i)):i(new Error("zlib binding closed")):i(new Error("invalid input"))},F.prototype._processChunk=function(e,n,i){var r=e&&e.length,o=this._chunkSize-this._offset,_=0,a=this,u="function"==typeof i;if(!u){var h=[],c=0,E;this.on("error",(function(e){E=e})),f(this._handle,"zlib binding closed");do{var d=this._handle.writeSync(n,e,_,r,this._buffer,this._offset,o)}while(!this._hadError&&L(d[0],d[1]));if(this._hadError)throw E;if(c>=s)throw b(this),new RangeError(l);var w=t.concat(h,c);return b(this),w}f(this._handle,"zlib binding closed");var Z=this._handle.write(n,e,_,r,this._buffer,this._offset,o);function L(s,l){if(this&&(this.buffer=null,this.callback=null),!a._hadError){var E=o-l;if(f(E>=0,"have should not go down"),E>0){var d=a._buffer.slice(a._offset,a._offset+E);a._offset+=E,u?a.push(d):(h.push(d),c+=d.length)}if((0===l||a._offset>=a._chunkSize)&&(o=a._chunkSize,a._offset=0,a._buffer=t.allocUnsafe(a._chunkSize)),0===l){if(_+=r-s,r=s,!u)return!0;var w=a._handle.write(n,e,_,r,a._buffer,a._offset,a._chunkSize);return w.callback=L,void(w.buffer=e)}if(!u)return!1;i()}}Z.buffer=e,Z.callback=L},o.inherits(L,F),o.inherits(R,F),o.inherits(v,F),o.inherits(p,F),o.inherits(I,F),o.inherits(g,F),o.inherits(S,F)}

