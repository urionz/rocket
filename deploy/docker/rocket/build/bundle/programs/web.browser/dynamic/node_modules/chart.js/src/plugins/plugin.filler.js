function module(e,t,n){"use strict";var r=e("../core/core.defaults"),l=e("../elements/index"),i=e("../helpers/index");r._set("global",{plugins:{filler:{propagate:!0}}});var a={dataset:function(e){var t=e.fill,n=e.chart,r=n.getDatasetMeta(t),l,i=r&&n.isDatasetVisible(t)&&r.dataset._children||[],a=i.length||0;return a?function(e,t){return t<a&&i[t]._view||null}:null},boundary:function(e){var t=e.boundary,n=t?t.x:null,r=t?t.y:null;return function(e){return{x:null===n?e.x:n,y:null===r?e.y:r}}}};function o(e,t,n){var r=e._model||{},l=r.fill,i;if(void 0===l&&(l=!!r.backgroundColor),!1===l||null===l)return!1;if(!0===l)return"origin";if(i=parseFloat(l,10),isFinite(i)&&Math.floor(i)===i)return"-"!==l[0]&&"+"!==l[0]||(i=t+i),!(i===t||i<0||i>=n)&&i;switch(l){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return l;default:return!1}}function s(e){var t=e.el._model||{},n=e.el._scale||{},r=e.fill,l=null,i;if(isFinite(r))return null;if("start"===r?l=void 0===t.scaleBottom?n.bottom:t.scaleBottom:"end"===r?l=void 0===t.scaleTop?n.top:t.scaleTop:void 0!==t.scaleZero?l=t.scaleZero:n.getBasePosition?l=n.getBasePosition():n.getBasePixel&&(l=n.getBasePixel()),null!=l){if(void 0!==l.x&&void 0!==l.y)return l;if("number"==typeof l&&isFinite(l))return{x:(i=n.isHorizontal())?l:null,y:i?null:l}}return null}function u(e,t,n){var r,l=e[t].fill,i=[t],a;if(!n)return l;for(;!1!==l&&-1===i.indexOf(l);){if(!isFinite(l))return l;if(!(a=e[l]))return!1;if(a.visible)return l;i.push(l),l=a.fill}return!1}function f(e){var t=e.fill,n="dataset";return!1===t?null:(isFinite(t)||(n="boundary"),a[n](e))}function c(e){return e&&!e.skip}function d(e,t,n,r,l){var a;if(r&&l){for(e.moveTo(t[0].x,t[0].y),a=1;a<r;++a)i.canvas.lineTo(e,t[a-1],t[a]);for(e.lineTo(n[l-1].x,n[l-1].y),a=l-1;a>0;--a)i.canvas.lineTo(e,n[a],n[a-1],!0)}}function p(e,t,n,r,l,i){var a=t.length,o=r.spanGaps,s=[],u=[],f=0,p=0,v,g,h,b,m,x,y;for(e.beginPath(),v=0,g=a+!!i;v<g;++v)m=n(b=t[h=v%a]._view,h,r),x=c(b),y=c(m),x&&y?(f=s.push(b),p=u.push(m)):f&&p&&(o?(x&&s.push(b),y&&u.push(m)):(d(e,s,u,f,p),f=p=0,s=[],u=[]));d(e,s,u,f,p),e.closePath(),e.fillStyle=l,e.fill()}n.exports={id:"filler",afterDatasetsUpdate:function(e,t){var n=(e.data.datasets||[]).length,r=t.propagate,i=[],a,c,d,p;for(c=0;c<n;++c)p=null,(d=(a=e.getDatasetMeta(c)).dataset)&&d._model&&d instanceof l.Line&&(p={visible:e.isDatasetVisible(c),fill:o(d,c,n),chart:e,el:d}),a.$filler=p,i.push(p);for(c=0;c<n;++c)(p=i[c])&&(p.fill=u(i,c,r),p.boundary=s(p),p.mapper=f(p))},beforeDatasetDraw:function(e,t){var n=t.meta.$filler;if(n){var l=e.ctx,a=n.el,o=a._view,s=a._children||[],u=n.mapper,f=o.backgroundColor||r.global.defaultColor;u&&f&&s.length&&(i.canvas.clipArea(l,e.chartArea),p(l,s,u,o,f,a._loop),i.canvas.unclipArea(l))}}}}

