function module(e,n,t){"use strict";var r;function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var u=e("./end-of-stream"),i=Symbol("lastResolve"),o=Symbol("lastReject"),a=Symbol("error"),s=Symbol("ended"),c=Symbol("lastPromise"),f=Symbol("handlePromise"),v=Symbol("stream");function d(e,n){return{value:e,done:n}}function b(e){var n=e[i];if(null!==n){var t=e[v].read();null!==t&&(e[c]=null,e[i]=null,e[o]=null,n(d(t,!1)))}}function m(e){process.nextTick(b,e)}function h(e,n){return function(t,r){e.then((function(){n[s]?t(d(void 0,!0)):n[f](t,r)}),r)}}var y=Object.getPrototypeOf((function(){})),P=Object.setPrototypeOf((l(r={get stream(){return this[v]},next:function e(){var n=this,t=this[a];if(null!==t)return Promise.reject(t);if(this[s])return Promise.resolve(d(void 0,!0));if(this[v].destroyed)return new Promise((function(e,t){process.nextTick((function(){n[a]?t(n[a]):e(d(void 0,!0))}))}));var r=this[c],l;if(r)l=new Promise(h(r,this));else{var u=this[v].read();if(null!==u)return Promise.resolve(d(u,!1));l=new Promise(this[f])}return this[c]=l,l}},Symbol.asyncIterator,(function(){return this})),l(r,"return",(function e(){var n=this;return new Promise((function(e,t){n[v].destroy(null,(function(n){n?t(n):e(d(void 0,!0))}))}))})),r),y),w=function e(n){var t,r=Object.create(P,(l(t={},v,{value:n,writable:!0}),l(t,i,{value:null,writable:!0}),l(t,o,{value:null,writable:!0}),l(t,a,{value:null,writable:!0}),l(t,s,{value:n._readableState.endEmitted,writable:!0}),l(t,f,{value:function e(n,t){var l=r[v].read();l?(r[c]=null,r[i]=null,r[o]=null,n(d(l,!1))):(r[i]=n,r[o]=t)},writable:!0}),t));return r[c]=null,u(n,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var n=r[o];return null!==n&&(r[c]=null,r[i]=null,r[o]=null,n(e)),void(r[a]=e)}var t=r[i];null!==t&&(r[c]=null,r[i]=null,r[o]=null,t(d(void 0,!0))),r[s]=!0})),n.on("readable",m.bind(null,r)),r};t.exports=w}

