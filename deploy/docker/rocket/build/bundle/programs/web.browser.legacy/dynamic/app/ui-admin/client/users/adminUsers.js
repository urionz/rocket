function module(e,t,n){var r,a,s,i,u,o,f,c,l,d,v;n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){r=e}},0),n.link("@babel/runtime/regenerator",{default:function(e){a=e}},1),n.link("meteor/reactive-var",{ReactiveVar:function(e){s=e}},0),n.link("meteor/tracker",{Tracker:function(e){i=e}},1),n.link("meteor/kadira:flow-router",{FlowRouter:function(e){u=e}},2),n.link("meteor/templating",{Template:function(e){o=e}},3),n.link("underscore",{default:function(e){f=e}},4),n.link("../../../ui-utils",{SideNav:function(e){c=e},TabBar:function(e){l=e},RocketChatTabBar:function(e){d=e}},5),n.link("../../../utils/client",{APIClient:function(e){v=e}},6);var g=50;o.adminUsers.helpers({searchText:function(){var e=o.instance();return e.filter&&e.filter.get()},isReady:function(){var e=o.instance();return e.ready&&e.ready.get()},users:function(){return o.instance().users.get()},isLoading:function(){var e=o.instance();if(!e.ready||!e.ready.get())return"btn-loading"},hasMore:function(){var e=o.instance(),t=e.users();if(e.offset&&e.offset.get()&&t&&t.length)return e.offset.get()===t.length},emailAddress:function(){return f.map(this.emails,(function(e){return e.address})).join(", ")},flexData:function(){return{tabBar:o.instance().tabBar,data:o.instance().tabBarData.get()}},onTableScroll:function(){var e=o.instance();return function(t){if(t.offsetHeight+t.scrollTop>=t.scrollHeight-100)return e.offset.set(e.offset.get()+g)}},statusDeactivated:function(){return o.instance().statusDeactivated.get()},statusOptions:function(){return o.instance().statusOptions.get()}}),o.adminUsers.onCreated((function(){var e=this,t=this;this.offset=new s(0),this.filter=new s(""),this.status=new s(""),this.ready=new s(!0),this.tabBar=new d,this.tabBar.showGroup(u.current().route.name),this.tabBarData=new s,this.users=new s([]),this.statusDeactivated=new s({value:"deactivated",label:"未激活"}),this.statusOptions=new s([{value:"online",label:"在线"},{value:"offline",label:"离线"},{value:"away",label:"离开"},{value:"busy",label:"忙碌"}]),l.addButton({groups:["admin-users"],id:"invite-user",i18nTitle:"Invite_Users",icon:"send",template:"adminInviteUser",order:1}),l.addButton({groups:["admin-users"],id:"add-user",i18nTitle:"Add_User",icon:"plus",template:"adminUserEdit",order:2}),l.addButton({groups:["admin-users"],id:"admin-user-info",i18nTitle:"User_Info",icon:"user",template:"adminUserInfo",order:3}),this.loadUsers=function(){function t(t,n){var r,s,i,u,o,f=arguments;return a.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:"",e.ready.set(!1),s={$or:[{"emails.address":{$regex:t,$options:"i"}},{username:{$regex:t,$options:"i"}},{name:{$regex:t,$options:"i"}}]},""!==r&&(r===e.statusDeactivated.value?s.active=!1:s.status=r),i="users.list?count="+g+"&offset="+n,(t||r)&&(i+="&query="+JSON.stringify(s)),c.next=8,a.awrap(v.v1.get(i));case 8:u=c.sent,o=u.users,0===n?e.users.set(o):e.users.set(e.users.get().concat(o)),e.ready.set(!0);case 12:case"end":return c.stop()}}return c}())}return t}(),this.autorun(function(){function n(){var n,r,s;return a.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:n=t.filter.get(),r=t.offset.get(),s=t.status.get(),e.loadUsers(n,r,s);case 4:case"end":return a.stop()}}return a}())}return n}())})),o.adminUsers.onRendered((function(){i.afterFlush((function(){c.setFlex("adminFlex"),c.openFlex()}))}));var p=300;o.adminUsers.events({"keydown #users-filter":function(e){13===e.which&&(e.stopPropagation(),e.preventDefault())},"keyup #users-filter":f.debounce((function(e,t){e.stopPropagation(),e.preventDefault(),t.filter.set(e.currentTarget.value),t.offset.set(0)}),300),"click .user-info":function(e,t){var n=this;e.preventDefault(),t.tabBarData.set(r({},t.users.get().find((function(e){return e._id===n._id})),{onChange:function(){var e=t.filter.get(),n=t.offset.get(),r=t.status.get();t.loadUsers(e,n,r)}})),t.tabBar.open("admin-user-info")},"click .info-tabs button":function(e){e.preventDefault(),$(".info-tabs button").removeClass("active"),$(e.currentTarget).addClass("active"),$(".user-info-content").hide(),$($(e.currentTarget).attr("href")).show()},"click .load-more":function(e,t){e.preventDefault(),e.stopPropagation(),t.offset.set(t.offset.get()+g)},"change #filter-status":function(e,t){t.status.set(e.currentTarget.value),t.offset.set(0)}})}

