function module(t,a,i){"use strict";var o=t("../helpers/index"),e=t("../core/core.scale"),n=t("../core/core.scaleService"),r=t("../core/core.ticks");function l(t,a){var i=[],e=o.valueOrDefault,n=e(t.min,Math.pow(10,Math.floor(o.log10(a.min)))),r=Math.floor(o.log10(a.max)),l=Math.ceil(a.max/Math.pow(10,r)),s,m;0===n?(s=Math.floor(o.log10(a.minNotZero)),m=Math.floor(a.minNotZero/Math.pow(10,s)),i.push(n),n=m*Math.pow(10,s)):(s=Math.floor(o.log10(n)),m=Math.floor(n/Math.pow(10,s)));var h=s<0?Math.pow(10,Math.abs(s)):1;do{i.push(n),10===++m&&(m=1,h=++s>=0?1:h),n=Math.round(m*Math.pow(10,s)*h)/h}while(s<r||s===r&&m<l);var c=e(t.max,n);return i.push(c),i}i.exports=function(t){var a={position:"left",ticks:{callback:r.formatters.logarithmic}},i=e.extend({determineDataLimits:function(){var t=this,a=t.options,i=t.chart,e,n=i.data.datasets,r=t.isHorizontal();function l(a){return r?a.xAxisID===t.id:a.yAxisID===t.id}t.min=null,t.max=null,t.minNotZero=null;var s=a.stacked;if(void 0===s&&o.each(n,(function(t,a){if(!s){var o=i.getDatasetMeta(a);i.isDatasetVisible(a)&&l(o)&&void 0!==o.stack&&(s=!0)}})),a.stacked||s){var m={};o.each(n,(function(e,n){var r=i.getDatasetMeta(n),s=[r.type,void 0===a.stacked&&void 0===r.stack?n:"",r.stack].join(".");i.isDatasetVisible(n)&&l(r)&&(void 0===m[s]&&(m[s]=[]),o.each(e.data,(function(a,i){var o=m[s],e=+t.getRightValue(a);isNaN(e)||r.data[i].hidden||e<0||(o[i]=o[i]||0,o[i]+=e)})))})),o.each(m,(function(a){if(a.length>0){var i=o.min(a),e=o.max(a);t.min=null===t.min?i:Math.min(t.min,i),t.max=null===t.max?e:Math.max(t.max,e)}}))}else o.each(n,(function(a,e){var n=i.getDatasetMeta(e);i.isDatasetVisible(e)&&l(n)&&o.each(a.data,(function(a,i){var o=+t.getRightValue(a);isNaN(o)||n.data[i].hidden||o<0||(null===t.min?t.min=o:o<t.min&&(t.min=o),null===t.max?t.max=o:o>t.max&&(t.max=o),0!==o&&(null===t.minNotZero||o<t.minNotZero)&&(t.minNotZero=o))}))}));this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,a,i=t.options.ticks,e=o.valueOrDefault,n=1,r=10;t.min=e(i.min,t.min),t.max=e(i.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(o.log10(t.min))-1),t.max=Math.pow(10,Math.floor(o.log10(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(o.log10(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(o.log10(t.min))+1):10),null===t.minNotZero&&(t.min>0?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(o.log10(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,a,i=t.options.ticks,e=!t.isHorizontal(),n={min:i.min,max:i.max},r=t.ticks=l(n,t);t.max=o.max(r),t.min=o.min(r),i.reverse?(e=!e,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),e&&r.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),e.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,a){return+this.getRightValue(this.chart.data.datasets[a].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},_getFirstTickValue:function(t){var a=Math.floor(o.log10(t)),i;return Math.floor(t/Math.pow(10,a))*Math.pow(10,a)},getPixelForValue:function(a){var i=this,e=i.options.ticks.reverse,n=o.log10,r=i._getFirstTickValue(i.minNotZero),l=0,s,m,h,c,u;return a=+i.getRightValue(a),e?(h=i.end,c=i.start,u=-1):(h=i.start,c=i.end,u=1),i.isHorizontal()?(s=i.width,m=e?i.right:i.left):(s=i.height,u*=-1,m=e?i.top:i.bottom),a!==h&&(0===h&&(s-=l=o.getValueOrDefault(i.options.ticks.fontSize,t.defaults.global.defaultFontSize),h=r),0!==a&&(l+=s/(n(c)-n(h))*(n(a)-n(h))),m+=u*l),m},getValueForPixel:function(a){var i=this,e=i.options.ticks.reverse,n=o.log10,r=i._getFirstTickValue(i.minNotZero),l,s,m,h;if(e?(s=i.end,m=i.start):(s=i.start,m=i.end),i.isHorizontal()?(l=i.width,h=e?i.right-a:a-i.left):(l=i.height,h=e?a-i.top:i.bottom-a),h!==s){if(0===s){var c=o.getValueOrDefault(i.options.ticks.fontSize,t.defaults.global.defaultFontSize);h-=c,l-=c,s=r}h*=n(m)-n(s),h/=l,h=Math.pow(10,n(s)+h)}return h}});n.registerScaleType("logarithmic",i,a)}}

