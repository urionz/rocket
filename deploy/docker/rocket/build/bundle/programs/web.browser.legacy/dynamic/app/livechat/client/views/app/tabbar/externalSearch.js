function module(e,t,n){var a,s,r,o;n.link("@babel/runtime/regenerator",{default:function(e){a=e}},0),n.link("meteor/templating",{Template:function(e){s=e}},0),n.link("meteor/reactive-var",{ReactiveVar:function(e){r=e}},1),n.link("./externalSearch.html"),n.link("../../../../../utils/client",{APIClient:function(e){o=e}},2);var i=50;s.externalSearch.helpers({messages:function(){return s.instance().externalMessages.get()},hasMore:function(){var e=s.instance(),t=e.externalMessages.get();return e.total.get()>t.length}}),s.externalSearch.events({"click button.pick-message":function(e,t){e.preventDefault(),$("#chat-window-"+t.roomId+" .js-input-message").val(this.msg).focus()},"click .load-more":function(e,t){e.preventDefault(),e.stopPropagation(),t.offset.set(t.offset.get()+i)},"click .load-more-livechat-external-messages":function(e,t){return t.offset.set(t.offset.get()+i)}}),s.externalSearch.onCreated((function(){var e=this;this.roomId=null,this.externalMessages=new r([]),this.offset=new r(0),this.ready=new r(!0),this.total=new r(0),this.autorun(function(){function t(){var t,n,r,c;return a.async(function(){function l(l){for(;;)switch(l.prev=l.next){case 0:if(e.ready.set(!1),t=e.offset.get(),e.roomId=s.currentData().rid,!e.roomId){l.next=11;break}return l.next=6,a.awrap(o.v1.get("livechat/messages.external/"+e.roomId+"?count="+i+"&offset="+t));case 6:n=l.sent,r=n.messages,c=n.total,e.total.set(c),0===t?e.externalMessages.set(r):e.externalMessages.set(e.externalMessages.get().concat(r));case 11:e.ready.set(!0);case 12:case"end":return l.stop()}}return l}())}return t}())}))}

