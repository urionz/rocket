function module(t,e,i){"use strict";var n=t("moment");n="function"==typeof n?n:window.moment;var o=t("../core/core.defaults"),a=t("../helpers/index"),r=t("../core/core.scale"),s=t("../core/core.scaleService"),l=Number.MIN_SAFE_INTEGER||-9007199254740991,u=Number.MAX_SAFE_INTEGER||9007199254740991,m={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},f=Object.keys(m);function h(t,e){return t-e}function c(t){var e={},i=[],n,o,a;for(n=0,o=t.length;n<o;++n)e[a=t[n]]||(e[a]=!0,i.push(a));return i}function d(t,e,i,n){if("linear"===n||!t.length)return[{time:e,pos:0},{time:i,pos:1}];var o=[],a=[e],r,s,l,u,m;for(r=0,s=t.length;r<s;++r)(u=t[r])>e&&u<i&&a.push(u);for(a.push(i),r=0,s=a.length;r<s;++r)m=a[r+1],l=a[r-1],u=a[r],void 0!==l&&void 0!==m&&Math.round((m+l)/2)===u||o.push({time:u,pos:r/(s-1)});return o}function p(t,e,i){for(var n=0,o=t.length-1,a,r,s;n>=0&&n<=o;){if(r=t[(a=n+o>>1)-1]||null,s=t[a],!r)return{lo:null,hi:s};if(s[e]<i)n=a+1;else{if(!(r[e]>i))return{lo:r,hi:s};o=a-1}}return{lo:s,hi:null}}function g(t,e,i,n){var o=p(t,e,i),a=o.lo?o.hi?o.lo:t[t.length-2]:t[0],r=o.lo?o.hi?o.hi:t[t.length-1]:t[1],s=r[e]-a[e],l=s?(i-a[e])/s:0,u=(r[n]-a[n])*l;return a[n]+u}function v(t,e){var i=e.parser,o=e.parser||e.format;return"function"==typeof i?i(t):"string"==typeof t&&"string"==typeof o?n(t,o):(t instanceof n||(t=n(t)),t.isValid()?t:"function"==typeof o?o(t):t)}function b(t,e){if(a.isNullOrUndef(t))return null;var i=e.options.time,n=v(e.getRightValue(t),i);return n.isValid()?(i.round&&n.startOf(i.round),n.valueOf()):null}function _(t,e,i,n){var o=e-t,a=m[i],r=a.size,s=a.steps,l,u,f;if(!s)return Math.ceil(o/(n*r));for(l=0,u=s.length;l<u&&(f=s[l],!(Math.ceil(o/(r*f))<=n));++l);return f}function y(t,e,i,n){var o=f.length,a,r,s;for(a=f.indexOf(t);a<o-1;++a)if(s=(r=m[f[a]]).steps?r.steps[r.steps.length-1]:u,r.common&&Math.ceil((i-e)/(s*r.size))<=n)return f[a];return f[o-1]}function M(t,e,i,o){var a=n.duration(n(o).diff(n(i))),r,s,l;for(s=f.length-1;s>=f.indexOf(e);s--)if(l=f[s],m[l].common&&a.as(l)>=t.length)return l;return f[e?f.indexOf(e):0]}function k(t){for(var e=f.indexOf(t)+1,i=f.length;e<i;++e)if(m[f[e]].common)return f[e]}function x(t,e,i,o){var r=o.time,s=r.unit||y(r.minUnit,t,e,i),l=k(s),u=a.valueOrDefault(r.stepSize,r.unitStepSize),f="week"===s&&r.isoWeekday,h=o.ticks.major.enabled,c=m[s],d=n(t),p=n(e),g=[],v;for(u||(u=_(t,e,s,i)),f&&(d=d.isoWeekday(f),p=p.isoWeekday(f)),d=d.startOf(f?"day":s),(p=p.startOf(f?"day":s))<e&&p.add(1,s),v=n(d),h&&l&&!f&&!r.round&&(v.startOf(l),v.add(~~((d-v)/(c.size*u))*u,s));v<p;v.add(u,s))g.push(+v);return g.push(+v),g}function O(t,e,i,n,o){var a=0,r=0,s,l;return o.offset&&e.length&&(o.time.min||(s=e.length>1?e[1]:n,l=e[0],a=(g(t,"time",s,"pos")-g(t,"time",l,"pos"))/2),o.time.max||(s=e[e.length-1],l=e.length>1?e[e.length-2]:i,r=(g(t,"time",s,"pos")-g(t,"time",l,"pos"))/2)),{left:a,right:r}}function z(t,e){var i=[],o,a,r,s;for(o=0,a=t.length;o<a;++o)r=t[o],s=!!e&&r===+n(r).startOf(e),i.push({value:r,major:s});return i}function Y(t,e){var i,n,o,a=t.length;for(i=0;i<a;i++){if(0!==(n=v(t[i],e)).millisecond())return"MMM D, YYYY h:mm:ss.SSS a";0===n.second()&&0===n.minute()&&0===n.hour()||(o=!0)}return o?"MMM D, YYYY h:mm:ss a":"MMM D, YYYY"}i.exports=function(){var t={position:"bottom",distribution:"linear",bounds:"data",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}},e=r.extend({initialize:function(){if(!n)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");this.mergeTicksOptions(),r.prototype.initialize.call(this)},update:function(){var t=this,e=t.options;return e.time&&e.time.format&&console.warn("options.time.format is deprecated and replaced by options.time.parser."),r.prototype.update.apply(t,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),r.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var t=this,e=t.chart,i=t.options.time,o=i.unit||"day",r=u,s=l,m=[],f=[],d=[],p,g,v,_,y,M;for(p=0,v=e.data.labels.length;p<v;++p)d.push(b(e.data.labels[p],t));for(p=0,v=(e.data.datasets||[]).length;p<v;++p)if(e.isDatasetVisible(p))if(y=e.data.datasets[p].data,a.isObject(y[0]))for(f[p]=[],g=0,_=y.length;g<_;++g)M=b(y[g],t),m.push(M),f[p][g]=M;else m.push.apply(m,d),f[p]=d.slice(0);else f[p]=[];d.length&&(d=c(d).sort(h),r=Math.min(r,d[0]),s=Math.max(s,d[d.length-1])),m.length&&(m=c(m).sort(h),r=Math.min(r,m[0]),s=Math.max(s,m[m.length-1])),r=b(i.min,t)||r,s=b(i.max,t)||s,r=r===u?+n().startOf(o):r,s=s===l?+n().endOf(o)+1:s,t.min=Math.min(r,s),t.max=Math.max(r+1,s),t._horizontal=t.isHorizontal(),t._table=[],t._timestamps={data:m,datasets:f,labels:d}},buildTicks:function(){var t=this,e=t.min,i=t.max,n=t.options,o=n.time,a=[],r=[],s,l,u;switch(n.ticks.source){case"data":a=t._timestamps.data;break;case"labels":a=t._timestamps.labels;break;case"auto":default:a=x(e,i,t.getLabelCapacity(e),n)}for("ticks"===n.bounds&&a.length&&(e=a[0],i=a[a.length-1]),e=b(o.min,t)||e,i=b(o.max,t)||i,s=0,l=a.length;s<l;++s)(u=a[s])>=e&&u<=i&&r.push(u);return t.min=e,t.max=i,t._unit=o.unit||M(r,o.minUnit,t.min,t.max),t._majorUnit=k(t._unit),t._table=d(t._timestamps.data,e,i,n.distribution),t._offsets=O(t._table,r,e,i,n),t._labelFormat=Y(t._timestamps.data,o),z(r,t._majorUnit)},getLabelForIndex:function(t,e){var i=this,n=i.chart.data,o=i.options.time,r=n.labels&&t<n.labels.length?n.labels[t]:"",s=n.datasets[e].data[t];return a.isObject(s)&&(r=i.getRightValue(s)),o.tooltipFormat?v(r,o).format(o.tooltipFormat):"string"==typeof r?r:v(r,o).format(i._labelFormat)},tickFormatFunction:function(t,e,i,n){var o=this,r=o.options,s=t.valueOf(),l=r.time.displayFormats,u=l[o._unit],m=o._majorUnit,f=l[m],h=t.clone().startOf(m).valueOf(),c=r.ticks.major,d=c.enabled&&m&&f&&s===h,p=t.format(n||(d?f:u)),g=d?c:r.ticks.minor,v=a.valueOrDefault(g.callback,g.userCallback);return v?v(p,e,i):p},convertTicksToLabels:function(t){var e=[],i,o;for(i=0,o=t.length;i<o;++i)e.push(this.tickFormatFunction(n(t[i].value),i,t));return e},getPixelForOffset:function(t){var e=this,i=e._horizontal?e.width:e.height,n=e._horizontal?e.left:e.top,o=g(e._table,"time",t,"pos");return n+i*(e._offsets.left+o)/(e._offsets.left+1+e._offsets.right)},getPixelForValue:function(t,e,i){var n=this,o=null;if(void 0!==e&&void 0!==i&&(o=n._timestamps.datasets[i][e]),null===o&&(o=b(t,n)),null!==o)return n.getPixelForOffset(o)},getPixelForTick:function(t){var e=this.getTicks();return t>=0&&t<e.length?this.getPixelForOffset(e[t].value):null},getValueForPixel:function(t){var e=this,i=e._horizontal?e.width:e.height,o=e._horizontal?e.left:e.top,a=(i?(t-o)/i:0)*(e._offsets.left+1+e._offsets.left)-e._offsets.right,r=g(e._table,"pos",a,"time");return n(r)},getLabelWidth:function(t){var e=this,i=e.options.ticks,n=e.ctx.measureText(t).width,r=a.toRadians(i.maxRotation),s=Math.cos(r),l=Math.sin(r),u;return n*s+a.valueOrDefault(i.fontSize,o.global.defaultFontSize)*l},getLabelCapacity:function(t){var e=this,i=e.options.time.displayFormats.millisecond,o=e.tickFormatFunction(n(t),0,[],i),a=e.getLabelWidth(o),r=e.isHorizontal()?e.width:e.height,s=Math.floor(r/a);return s>0?s:1}});s.registerScaleType("time",e,t)}}

