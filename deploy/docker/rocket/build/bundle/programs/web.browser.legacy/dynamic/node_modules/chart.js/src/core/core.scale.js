function module(t,i,e){"use strict";var o=t("./core.defaults"),a=t("./core.element"),n=t("../helpers/index"),r=t("./core.ticks");function l(t){var i=[],e,o;for(e=0,o=t.length;e<o;++e)i.push(t[e].label);return i}function s(t,i,e){var o=t.getPixelForTick(i);return e&&(o-=0===i?(t.getPixelForTick(1)-o)/2:(o-t.getPixelForTick(i-1))/2),o}function f(t,i,e){return n.isArray(i)?n.longestText(t,e,i):t.measureText(i).width}function d(t){var i=n.valueOrDefault,e=o.global,a=i(t.fontSize,e.defaultFontSize),r=i(t.fontStyle,e.defaultFontStyle),l=i(t.fontFamily,e.defaultFontFamily);return{size:a,style:r,family:l,font:n.fontString(a,r,l)}}function h(t){return n.options.toLineHeight(n.valueOrDefault(t.lineHeight,1.2),n.valueOrDefault(t.fontSize,o.global.defaultFontSize))}o._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",lineHeight:1.2,padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:r.formatters.values,minor:{},major:{}}}),e.exports=a.extend({getPadding:function(){var t=this;return{left:t.paddingLeft||0,top:t.paddingTop||0,right:t.paddingRight||0,bottom:t.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var t=this.options.ticks;for(var i in!1===t.minor&&(t.minor={display:!1}),!1===t.major&&(t.major={display:!1}),t)"major"!==i&&"minor"!==i&&(void 0===t.minor[i]&&(t.minor[i]=t[i]),void 0===t.major[i]&&(t.major[i]=t[i]))},beforeUpdate:function(){n.callback(this.options.beforeUpdate,[this])},update:function(t,i,e){var o=this,a,r,l,s,f,d;for(o.beforeUpdate(),o.maxWidth=t,o.maxHeight=i,o.margins=n.extend({left:0,right:0,top:0,bottom:0},e),o.longestTextCache=o.longestTextCache||{},o.beforeSetDimensions(),o.setDimensions(),o.afterSetDimensions(),o.beforeDataLimits(),o.determineDataLimits(),o.afterDataLimits(),o.beforeBuildTicks(),f=o.buildTicks()||[],o.afterBuildTicks(),o.beforeTickToLabelConversion(),l=o.convertTicksToLabels(f)||o.ticks,o.afterTickToLabelConversion(),o.ticks=l,a=0,r=l.length;a<r;++a)s=l[a],(d=f[a])?d.label=s:f.push(d={label:s,major:!1});return o._ticks=f,o.beforeCalculateTickRotation(),o.calculateTickRotation(),o.afterCalculateTickRotation(),o.beforeFit(),o.fit(),o.afterFit(),o.afterUpdate(),o.minSize},afterUpdate:function(){n.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){n.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){n.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){n.callback(this.options.beforeDataLimits,[this])},determineDataLimits:n.noop,afterDataLimits:function(){n.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){n.callback(this.options.beforeBuildTicks,[this])},buildTicks:n.noop,afterBuildTicks:function(){n.callback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){n.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this,i=t.options.ticks;t.ticks=t.ticks.map(i.userCallback||i.callback,this)},afterTickToLabelConversion:function(){n.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){n.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var t=this,i=t.ctx,e=t.options.ticks,o=l(t._ticks),a=d(e);i.font=a.font;var r=e.minRotation||0;if(o.length&&t.options.display&&t.isHorizontal())for(var s=n.longestText(i,a.font,o,t.longestTextCache),f=s,h,g,c=t.getPixelForTick(1)-t.getPixelForTick(0)-6;f>c&&r<e.maxRotation;){var p=n.toRadians(r);if(h=Math.cos(p),(g=Math.sin(p))*s>t.maxHeight){r--;break}r++,f=h*s}t.labelRotation=r},afterCalculateTickRotation:function(){n.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){n.callback(this.options.beforeFit,[this])},fit:function(){var t=this,i=t.minSize={width:0,height:0},e=l(t._ticks),o=t.options,a=o.ticks,r=o.scaleLabel,s=o.gridLines,g=o.display,c=t.isHorizontal(),p=d(a),u=o.gridLines.tickMarkLength;if(i.width=c?t.isFullWidth()?t.maxWidth-t.margins.left-t.margins.right:t.maxWidth:g&&s.drawTicks?u:0,i.height=c?g&&s.drawTicks?u:0:t.maxHeight,r.display&&g){var m,b,k=h(r)+n.options.toPadding(r.padding).height;c?i.height+=k:i.width+=k}if(a.display&&g){var x=n.longestText(t.ctx,p.font,e,t.longestTextCache),T=n.numberOfLabelLines(e),v=.5*p.size,L=t.options.ticks.padding;if(c){t.longestLabelWidth=x;var D=n.toRadians(t.labelRotation),y=Math.cos(D),R,F=Math.sin(D)*x+p.size*T+v*(T-1)+v;i.height=Math.min(t.maxHeight,i.height+F+L),t.ctx.font=p.font;var z=f(t.ctx,e[0],p.font),B=f(t.ctx,e[e.length-1],p.font);0!==t.labelRotation?(t.paddingLeft="bottom"===o.position?y*z+3:y*v+3,t.paddingRight="bottom"===o.position?y*v+3:y*B+3):(t.paddingLeft=z/2+3,t.paddingRight=B/2+3)}else a.mirror?x=0:x+=L+v,i.width=Math.min(t.maxWidth,i.width+x),t.paddingTop=p.size/2,t.paddingBottom=p.size/2}t.handleMargins(),t.width=i.width,t.height=i.height},handleMargins:function(){var t=this;t.margins&&(t.paddingLeft=Math.max(t.paddingLeft-t.margins.left,0),t.paddingTop=Math.max(t.paddingTop-t.margins.top,0),t.paddingRight=Math.max(t.paddingRight-t.margins.right,0),t.paddingBottom=Math.max(t.paddingBottom-t.margins.bottom,0))},afterFit:function(){n.callback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){if(n.isNullOrUndef(t))return NaN;if("number"==typeof t&&!isFinite(t))return NaN;if(t)if(this.isHorizontal()){if(void 0!==t.x)return this.getRightValue(t.x)}else if(void 0!==t.y)return this.getRightValue(t.y);return t},getLabelForIndex:n.noop,getPixelForValue:n.noop,getValueForPixel:n.noop,getPixelForTick:function(t){var i=this,e=i.options.offset;if(i.isHorizontal()){var o,a=(i.width-(i.paddingLeft+i.paddingRight))/Math.max(i._ticks.length-(e?0:1),1),n=a*t+i.paddingLeft;e&&(n+=a/2);var r=i.left+Math.round(n);return r+=i.isFullWidth()?i.margins.left:0}var l=i.height-(i.paddingTop+i.paddingBottom);return i.top+t*(l/(i._ticks.length-1))},getPixelForDecimal:function(t){var i=this;if(i.isHorizontal()){var e,o=(i.width-(i.paddingLeft+i.paddingRight))*t+i.paddingLeft,a=i.left+Math.round(o);return a+=i.isFullWidth()?i.margins.left:0}return i.top+t*i.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var t=this,i=t.min,e=t.max;return t.beginAtZero?0:i<0&&e<0?e:i>0&&e>0?i:0},_autoSkip:function(t){var i,e=this,o=e.isHorizontal(),a=e.options.ticks.minor,r=t.length,l=n.toRadians(e.labelRotation),s=Math.cos(l),f=e.longestLabelWidth*s,d=[],h,g,c,p;for(a.maxTicksLimit&&(p=a.maxTicksLimit),o&&(i=!1,(f+a.autoSkipPadding)*r>e.width-(e.paddingLeft+e.paddingRight)&&(i=1+Math.floor((f+a.autoSkipPadding)*r/(e.width-(e.paddingLeft+e.paddingRight)))),p&&r>p&&(i=Math.max(i,Math.floor(r/p)))),h=0;h<r;h++)g=t[h],(c=i>1&&h%i>0||h%i==0&&h+i>=r)&&h!==r-1&&delete g.label,d.push(g);return d},draw:function(t){var i=this,e=i.options;if(e.display){var a=i.ctx,r=o.global,l=e.ticks.minor,f=e.ticks.major||l,g=e.gridLines,c=e.scaleLabel,p=0!==i.labelRotation,u=i.isHorizontal(),m=l.autoSkip?i._autoSkip(i.getTicks()):i.getTicks(),b=n.valueOrDefault(l.fontColor,r.defaultFontColor),k=d(l),x=n.valueOrDefault(f.fontColor,r.defaultFontColor),T=d(f),v=g.drawTicks?g.tickMarkLength:0,L=n.valueOrDefault(c.fontColor,r.defaultFontColor),D=d(c),y=n.options.toPadding(c.padding),R=n.toRadians(i.labelRotation),F=[],z=i.options.gridLines.lineWidth,B="right"===e.position?i.left:i.right-z-v,C="right"===e.position?i.left+v:i.right,O="bottom"===e.position?i.top+z:i.bottom-v-z,S="bottom"===e.position?i.top+z+v:i.bottom+z;if(n.each(m,(function(o,a){if(!n.isNullOrUndef(o.label)){var f=o.label,d,h,c,b,k,x,T,L,D,y,P,w,M,W;a===i.zeroLineIndex&&e.offset===g.offsetGridLines?(d=g.zeroLineWidth,h=g.zeroLineColor,c=g.zeroLineBorderDash,b=g.zeroLineBorderDashOffset):(d=n.valueAtIndexOrDefault(g.lineWidth,a),h=n.valueAtIndexOrDefault(g.color,a),c=n.valueOrDefault(g.borderDash,r.borderDash),b=n.valueOrDefault(g.borderDashOffset,r.borderDashOffset));var H="middle",A="middle",j=l.padding;if(u){var _=v+j;"bottom"===e.position?(A=p?"middle":"top",H=p?"right":"center",W=i.top+_):(A=p?"middle":"bottom",H=p?"left":"center",W=i.bottom-_);var I=s(i,a,g.offsetGridLines&&m.length>1);I<i.left&&(h="rgba(0,0,0,0)"),I+=n.aliasPixel(d),M=i.getPixelForTick(a)+l.labelOffset,k=T=D=P=I,x=O,L=S,y=t.top,w=t.bottom+z}else{var U="left"===e.position,V;l.mirror?(H=U?"left":"right",V=j):(H=U?"right":"left",V=v+j),M=U?i.right-V:i.left+V;var N=s(i,a,g.offsetGridLines&&m.length>1);N<i.top&&(h="rgba(0,0,0,0)"),N+=n.aliasPixel(d),W=i.getPixelForTick(a)+l.labelOffset,k=B,T=C,D=t.left,P=t.right+z,x=L=y=w=N}F.push({tx1:k,ty1:x,tx2:T,ty2:L,x1:D,y1:y,x2:P,y2:w,labelX:M,labelY:W,glWidth:d,glColor:h,glBorderDash:c,glBorderDashOffset:b,rotation:-1*R,label:f,major:o.major,textBaseline:A,textAlign:H})}})),n.each(F,(function(t){if(g.display&&(a.save(),a.lineWidth=t.glWidth,a.strokeStyle=t.glColor,a.setLineDash&&(a.setLineDash(t.glBorderDash),a.lineDashOffset=t.glBorderDashOffset),a.beginPath(),g.drawTicks&&(a.moveTo(t.tx1,t.ty1),a.lineTo(t.tx2,t.ty2)),g.drawOnChartArea&&(a.moveTo(t.x1,t.y1),a.lineTo(t.x2,t.y2)),a.stroke(),a.restore()),l.display){a.save(),a.translate(t.labelX,t.labelY),a.rotate(t.rotation),a.font=t.major?T.font:k.font,a.fillStyle=t.major?x:b,a.textBaseline=t.textBaseline,a.textAlign=t.textAlign;var e=t.label;if(n.isArray(e))for(var o=e.length,r=1.5*k.size,s=i.isHorizontal()?0:-r*(o-1)/2,f=0;f<o;++f)a.fillText(""+e[f],0,s),s+=r;else a.fillText(e,0,0);a.restore()}})),c.display){var P,w,M=0,W=h(c)/2;if(u)P=i.left+(i.right-i.left)/2,w="bottom"===e.position?i.bottom-W-y.bottom:i.top+W+y.top;else{var H="left"===e.position;P=H?i.left+W+y.top:i.right-W-y.top,w=i.top+(i.bottom-i.top)/2,M=H?-.5*Math.PI:.5*Math.PI}a.save(),a.translate(P,w),a.rotate(M),a.textAlign="center",a.textBaseline="middle",a.fillStyle=L,a.font=D.font,a.fillText(c.labelString,0,0),a.restore()}if(g.drawBorder){a.lineWidth=n.valueAtIndexOrDefault(g.lineWidth,0),a.strokeStyle=n.valueAtIndexOrDefault(g.color,0);var A=i.left,j=i.right+z,_=i.top,I=i.bottom+z,U=n.aliasPixel(a.lineWidth);u?(_=I="top"===e.position?i.bottom:i.top,_+=U,I+=U):(A=j="left"===e.position?i.right:i.left,A+=U,j+=U),a.beginPath(),a.moveTo(A,_),a.lineTo(j,I),a.stroke()}}}})}

