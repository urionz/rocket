function module(o,t,e){var r;r=function(o){"use strict";o.defineOption("foldGutter",!1,(function(t,n,i){i&&i!=o.Init&&(t.clearGutter(t.state.foldGutter.options.gutter),t.state.foldGutter=null,t.off("gutterClick",d),t.off("change",u),t.off("viewportChange",l),t.off("fold",c),t.off("unfold",c),t.off("swapDoc",u)),n&&(t.state.foldGutter=new e(r(n)),a(t),t.on("gutterClick",d),t.on("change",u),t.on("viewportChange",l),t.on("fold",c),t.on("unfold",c),t.on("swapDoc",u))}));var t=o.Pos;function e(o){this.options=o,this.from=this.to=0}function r(o){return!0===o&&(o={}),null==o.gutter&&(o.gutter="CodeMirror-foldgutter"),null==o.indicatorOpen&&(o.indicatorOpen="CodeMirror-foldgutter-open"),null==o.indicatorFolded&&(o.indicatorFolded="CodeMirror-foldgutter-folded"),o}function n(o,e){for(var r=o.findMarks(t(e,0),t(e+1,0)),n=0;n<r.length;++n)if(r[n].__isFold&&r[n].find().from.line==e)return r[n]}function i(o){if("string"==typeof o){var t=document.createElement("div");return t.className=o+" CodeMirror-guttermarker-subtle",t}return o.cloneNode(!0)}function f(o,e,r){var f=o.state.foldGutter.options,a=e,d=o.foldOption(f,"minFoldSize"),u=o.foldOption(f,"rangeFinder");o.eachLine(e,r,(function(e){var r=null;if(n(o,a))r=i(f.indicatorFolded);else{var l=t(a,0),c=u&&u(o,l);c&&c.to.line-c.from.line>=d&&(r=i(f.indicatorOpen))}o.setGutterMarker(e,f.gutter,r),++a}))}function a(o){var t=o.getViewport(),e=o.state.foldGutter;e&&(o.operation((function(){f(o,t.from,t.to)})),e.from=t.from,e.to=t.to)}function d(o,e,r){var i=o.state.foldGutter;if(i){var f=i.options;if(r==f.gutter){var a=n(o,e);a?a.clear():o.foldCode(t(e,0),f.rangeFinder)}}}function u(o){var t=o.state.foldGutter;if(t){var e=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){a(o)}),e.foldOnChangeTimeSpan||600)}}function l(o){var t=o.state.foldGutter;if(t){var e=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){var e=o.getViewport();t.from==t.to||e.from-t.to>20||t.from-e.to>20?a(o):o.operation((function(){e.from<t.from&&(f(o,e.from,t.from),t.from=e.from),e.to>t.to&&(f(o,t.to,e.to),t.to=e.to)}))}),e.updateViewportTimeSpan||400)}}function c(o,t){var e=o.state.foldGutter;if(e){var r=t.line;r>=e.from&&r<e.to&&f(o,r,r+1)}}},"object"==typeof t&&"object"==typeof e?r(o("../../lib/codemirror"),o("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],r):r(CodeMirror)}

