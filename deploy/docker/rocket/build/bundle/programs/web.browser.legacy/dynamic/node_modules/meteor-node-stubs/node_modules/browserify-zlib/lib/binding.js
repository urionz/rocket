function module(t,i){"use strict";var s=t("assert"),e=t("pako/lib/zlib/zstream"),r=t("pako/lib/zlib/deflate.js"),h=t("pako/lib/zlib/inflate.js"),o=t("pako/lib/zlib/constants");for(var n in o)i[n]=o[n];i.NONE=0,i.DEFLATE=1,i.INFLATE=2,i.GZIP=3,i.GUNZIP=4,i.DEFLATERAW=5,i.INFLATERAW=6,i.UNZIP=7;var a=31,_=139;function l(t){if("number"!=typeof t||t<i.DEFLATE||t>i.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}l.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,s(this.init_done,"close before init"),s(this.mode<=i.UNZIP),this.mode===i.DEFLATE||this.mode===i.GZIP||this.mode===i.DEFLATERAW?r.deflateEnd(this.strm):this.mode!==i.INFLATE&&this.mode!==i.GUNZIP&&this.mode!==i.INFLATERAW&&this.mode!==i.UNZIP||h.inflateEnd(this.strm),this.mode=i.NONE,this.dictionary=null)},l.prototype.write=function(t,i,s,e,r,h,o){return this._write(!0,t,i,s,e,r,h,o)},l.prototype.writeSync=function(t,i,s,e,r,h,o){return this._write(!1,t,i,s,e,r,h,o)},l.prototype._write=function(t,e,r,h,o,n,a,_){if(s.equal(arguments.length,8),s(this.init_done,"write before init"),s(this.mode!==i.NONE,"already finalized"),s.equal(!1,this.write_in_progress,"write already in progress"),s.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,s.equal(!1,void 0===e,"must provide flush value"),this.write_in_progress=!0,e!==i.Z_NO_FLUSH&&e!==i.Z_PARTIAL_FLUSH&&e!==i.Z_SYNC_FLUSH&&e!==i.Z_FULL_FLUSH&&e!==i.Z_FINISH&&e!==i.Z_BLOCK)throw new Error("Invalid flush value");if(null==r&&(r=Buffer.alloc(0),o=0,h=0),this.strm.avail_in=o,this.strm.input=r,this.strm.next_in=h,this.strm.avail_out=_,this.strm.output=n,this.strm.next_out=a,this.flush=e,!t)return this._process(),this._checkError()?this._afterSync():void 0;var l=this;return process.nextTick((function(){l._process(),l._after()})),this},l.prototype._afterSync=function(){var t=this.strm.avail_out,i=this.strm.avail_in;return this.write_in_progress=!1,[i,t]},l.prototype._process=function(){var t=null;switch(this.mode){case i.DEFLATE:case i.GZIP:case i.DEFLATERAW:this.err=r.deflate(this.strm,this.flush);break;case i.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=i.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=i.GUNZIP):this.mode=i.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case i.INFLATE:case i.GUNZIP:case i.INFLATERAW:for(this.err=h.inflate(this.strm,this.flush),this.err===i.Z_NEED_DICT&&this.dictionary&&(this.err=h.inflateSetDictionary(this.strm,this.dictionary),this.err===i.Z_OK?this.err=h.inflate(this.strm,this.flush):this.err===i.Z_DATA_ERROR&&(this.err=i.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===i.GUNZIP&&this.err===i.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=h.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},l.prototype._checkError=function(){switch(this.err){case i.Z_OK:case i.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===i.Z_FINISH)return this._error("unexpected end of file"),!1;break;case i.Z_STREAM_END:break;case i.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},l.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,i=this.strm.avail_in;this.write_in_progress=!1,this.callback(i,t),this.pending_close&&this.close()}},l.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},l.prototype.init=function(t,e,r,h,o){s(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),s(t>=8&&t<=15,"invalid windowBits"),s(e>=-1&&e<=9,"invalid compression level"),s(r>=1&&r<=9,"invalid memlevel"),s(h===i.Z_FILTERED||h===i.Z_HUFFMAN_ONLY||h===i.Z_RLE||h===i.Z_FIXED||h===i.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(e,t,r,h,o),this._setDictionary()},l.prototype.params=function(){throw new Error("deflateParams Not supported")},l.prototype.reset=function(){this._reset(),this._setDictionary()},l.prototype._init=function(t,s,o,n,a){switch(this.level=t,this.windowBits=s,this.memLevel=o,this.strategy=n,this.flush=i.Z_NO_FLUSH,this.err=i.Z_OK,this.mode!==i.GZIP&&this.mode!==i.GUNZIP||(this.windowBits+=16),this.mode===i.UNZIP&&(this.windowBits+=32),this.mode!==i.DEFLATERAW&&this.mode!==i.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new e,this.mode){case i.DEFLATE:case i.GZIP:case i.DEFLATERAW:this.err=r.deflateInit2(this.strm,this.level,i.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case i.INFLATE:case i.GUNZIP:case i.INFLATERAW:case i.UNZIP:this.err=h.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==i.Z_OK&&this._error("Init error"),this.dictionary=a,this.write_in_progress=!1,this.init_done=!0},l.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=i.Z_OK,this.mode){case i.DEFLATE:case i.DEFLATERAW:this.err=r.deflateSetDictionary(this.strm,this.dictionary)}this.err!==i.Z_OK&&this._error("Failed to set dictionary")}},l.prototype._reset=function(){switch(this.err=i.Z_OK,this.mode){case i.DEFLATE:case i.DEFLATERAW:case i.GZIP:this.err=r.deflateReset(this.strm);break;case i.INFLATE:case i.INFLATERAW:case i.GUNZIP:this.err=h.inflateReset(this.strm)}this.err!==i.Z_OK&&this._error("Failed to reset stream")},i.Zlib=l}

