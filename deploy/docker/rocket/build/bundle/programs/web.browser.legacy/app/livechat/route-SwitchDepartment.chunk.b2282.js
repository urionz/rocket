(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{"7i70":function(t,e,r){"use strict";(function(t,n){r.d(e,"a",function(){return w});var a=r("gDde"),o=r("co3k"),i=r("z4Qk"),c=r("qoM+"),u=r("jdJj"),l=r("PyG4"),s=r("Aimb"),d=r.n(s);function f(){return(f=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function p(t){for(var e=1;arguments.length>e;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(r,!0).forEach(function(e){v(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b=t.t("Change Department"),y=t.t("Choose a department"),g=n(u.b.Footer,null),w=function(e){var r,a;function s(t){var r;v(m(r=e.call(this,t)||this),"state",{department:null}),v(m(r),"validations",{department:[c.e.nonEmpty]}),v(m(r),"getValidableFields",function(){return Object.keys(r.validations).map(function(t){return r.state[t]?p({fieldName:t},r.state[t]):null}).filter(Boolean)}),v(m(r),"validate",function(t,e){return r.validations[t].reduce(function(t,r){return t||r(e)},void 0)}),v(m(r),"validateAll",function(){var t=r.getValidableFields(),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var a,o;if(e){if(n>=t.length)break;o=t[n++]}else{if((n=t.next()).done)break;o=n.value}var i=o.fieldName,c=o.value,u=r.validate(i,c);r.setState(((a={})[i]=p({},r.state[i],{value:c,error:u,showError:!1}),a))}}),v(m(r),"isValid",function(){return r.getValidableFields().every(function(t){return!(void 0===t?{}:t).error})}),v(m(r),"handleFieldChange",function(t){return function(e){var n,a=e.target.value,o=r.validate(t,a);r.setState(((n={})[t]=p({},r.state[t],{value:a,error:o,showError:!1}),n))}}),v(m(r),"handleDepartmentChange",r.handleFieldChange("department")),v(m(r),"handleSubmit",function(t){if(t.preventDefault(),r.props.onSubmit){var e=Object.entries(r.state).filter(function(t){return null!==t[1]}).map(function(t){var e;return(e={})[t[0]]=t[1].value,e}).reduce(function(t,e){return p({},t,{},e)},{});r.props.onSubmit(e)}}),v(m(r),"handleCancelClick",function(){var t=r.props.onCancel;t&&t()});var n=t.departments;return n&&n.length>0&&(r.state.department={value:""}),r.validateAll(),r}a=e,(r=s).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a;var h=s.prototype;return h.componentWillReceiveProps=function(){this.state.department||this.setState({department:p({},this.state.department,{value:""})})},h.render=function(e,r){var a=r.department,s=e.title,h=e.color,p=e.message,m=e.loading,v=e.departments,w=function(t,e){if(null==t)return{};var r,n,a={},o=Object.keys(t);for(n=0;o.length>n;n++)0>e.indexOf(r=o[n])&&(a[r]=t[r]);return a}(e,["title","color","message","loading","departments"]),O=this.isValid();return n(u.b,f({color:h,title:s||b,className:Object(l.d)(d.a,"switch-department")},w),n(u.b.Content,null,n("p",{className:Object(l.d)(d.a,"switch-department__message")},p||y),n(c.a,{onSubmit:this.handleSubmit},n(c.b,{label:t.t("Departments"),error:a&&a.showError&&a.error},n(c.c,{name:"department",value:a&&a.value,options:v.map(function(t){return{value:t._id,label:t.name}}),placeholder:t.t("Choose a department..."),disabled:m,error:a&&a.showError,onInput:this.handleDepartmentChange})),n(i.a,null,n(o.a,{submit:!0,loading:m,disabled:!O||m,stack:!0},t.t("Start chat")),n(o.a,{disabled:m,stack:!0,secondary:!0,nude:!0,onClick:this.handleCancelClick},t.t("Cancel"))))),g)},s}(a.Component)}).call(this,r("fsQa").default,r("gDde").h)},POey:function(t,e,r){"use strict";r.r(e);var n=r("7i70");r.d(e,"SwitchDepartment",function(){return n.a});var a=r("xFLU");r.d(e,"SwitchDepartmentContainer",function(){return a.b}),r.d(e,"SwitchDepartmentConnector",function(){return a.a}),r.d(e,"default",function(){return a.c})},xFLU:function(t,e,r){"use strict";(function(t,n){r.d(e,"b",function(){return m}),r.d(e,"a",function(){return v});var a=r("gDde"),o=r("qPgm"),i=r("UEyv"),c=r("kQFM"),u=r("7i70"),l=r("81xT"),s=r("PyG4"),d=r("SGp1");function f(){return(f=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var m=function(e){var r,a;function c(){for(var r,a=arguments.length,c=new Array(a),m=0;a>m;m++)c[m]=arguments[m];return p(h(r=e.call.apply(e,[this].concat(c))||this),"confirmChangeDepartment",function(){return new Promise(function(e,r){var n;return Promise.resolve(l.a.confirm({text:t.t("Are you sure you want to switch the department?")})).then(function(t){try{return e("boolean"==typeof(n=t).success&&n.success)}catch(t){return r(t)}},r)})}),p(h(r),"handleSubmit",function(e){return new Promise(function(n,a){var c,u,f,h,p,m;return u=(c=r.props).alerts,f=c.dispatch,h=c.room,p=c.token,m=e.department,Promise.resolve(r.confirmChangeDepartment()).then(function(e){try{if(!e)return n();if(!h)return Promise.resolve(o.a.grantVisitor({visitor:{department:m,token:p}})).then(function(){try{return Promise.resolve(Object(i.a)()).then(function(){try{return Promise.resolve(f({alerts:(u.push({id:Object(s.e)(),children:t.t("Department switched"),success:!0}),u)})).then(function(){try{return n(d.a.go(-1))}catch(t){return a(t)}},a)}catch(t){return a(t)}},a)}catch(t){return a(t)}},a);var r=function(t){return function(e){try{return Promise.resolve(f({loading:!1})).then(function(){try{return t&&t.call(this,e)}catch(t){return a(t)}}.bind(this),a)}catch(t){return a(t)}}.bind(this)}.bind(this);return Promise.resolve(f({loading:!0})).then(function(){try{var e=function(){try{return n()}catch(t){return a(t)}},c=function(){try{return Promise.resolve(f({alerts:(u.push({id:Object(s.e)(),children:t.t("No available agents to transfer"),warning:!0}),u)})).then(function(){try{return r(e)()}catch(t){return a(t)}},a)}catch(t){return r(a)(t)}};try{return Promise.resolve(o.a.transferChat({rid:h._id,department:m})).then(function(n){try{if(!n.success)throw t.t("No available agents to transfer");return Promise.resolve(f({department:m})).then(function(){try{return Promise.resolve(Object(i.a)()).then(function(){try{return Promise.resolve(l.a.alert({text:t.t("Department switched")})).then(function(){try{return d.a.go(-1),r(e)()}catch(t){return c()}},c)}catch(t){return c()}},c)}catch(t){return c()}},c)}catch(t){return c()}},c)}catch(t){c()}}catch(t){return a(t)}},a)}catch(t){return a(t)}}.bind(this),a)})}),p(h(r),"handleCancel",function(){d.a.go(-1)}),p(h(r),"render",function(t){return n(u.a,f({},t,{onSubmit:r.handleSubmit,onCancel:r.handleCancel}))}),r}return a=e,(r=c).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a,c}(a.Component),v=function(t){var e=t.ref,r=function(t,e){if(null==t)return{};var r,n,a={},o=Object.keys(t);for(n=0;o.length>n;n++)0>e.indexOf(r=o[n])&&(a[r]=t[r]);return a}(t,["ref"]);return n(c.a,null,function(t){var a=t.config,o=(a=void 0===a?{}:a).departments,i=a.theme;i=void 0===i?{}:i;var c=t.iframe,u=(c=void 0===c?{}:c).theme,l=t.room,s=t.loading,d=t.department,h=t.dispatch,p=t.alerts,v=t.token;return n(m,f({ref:e},r,{theme:{color:(u=void 0===u?{}:u).color||i.color,fontColor:u.fontColor,iconColor:u.iconColor},loading:void 0!==s&&s,departments:(void 0===o?{}:o).filter(function(t){return t.showOnRegistration&&t._id!==d}),dispatch:h,room:l,alerts:p,token:v}))})};e.c=v}).call(this,r("fsQa").default,r("gDde").h)}}]);